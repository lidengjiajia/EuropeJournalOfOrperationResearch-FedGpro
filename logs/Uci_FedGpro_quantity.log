==================================================
goal = quantity
device = cuda
device_id = 1
dataset = Uci
num_classes = 10
model = credit
batch_size = 64
local_learning_rate = 0.007
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
top_cnt = 100
local_epochs = 5
algorithm = FedGpro
join_ratio = 1.0
random_join_ratio = False
num_clients = 10
prev = 0
times = 5
eval_gap = 1
save_folder_name = system/models/Uci_FedGpro_quantity
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.05
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 3
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
first_stage_bound = 0
fedcross_alpha = 0.99
collaberative_model_select_strategy = 1
fedgpro_phase = 1
fedgpro_use_vae = True
fedgpro_use_prototype = True
fedgpro_epsilon = None
fedgpro_noise_type = None
fedgpro_delta = 1e-05
fedgpro_adaptive_noise = False
fedgpro_adaptive_strategy = balanced
fedgpro_utility_weight = 1.0
fedgpro_use_iadp = False
fedgpro_iadp_alpha = 0.3
fedgpro_iadp_importance_method = vae_contrast
fedgpro_iadp_importance_momentum = 0.9
fedgpro_iadp_privacy_priority = False
fedgpro_lambda_cls = 10.0
fedgpro_lambda_recon = 1.0
fedgpro_lambda_kl = 0.1
fedgpro_lambda_proto = 0.1
fedgpro_proto_momentum = 0.95
fedgpro_latent_dim = None
fedgpro_vae_lr = 0.001
fedgpro_proto_align_lr = 0.001
fedgpro_threshold_min = 0.6
fedgpro_phase_transition_threshold = 0.7
fedgpro_phase2_agg = ditto
fedgpro_phase2_rounds = 50
reserved_clients = []
gwo_alpha_decay = 0.015
pso_w_max = 0.9
pso_w_min = 0.4
pso_c1 = 2.0
pso_c2 = 2.0
pso_v_max = 0.5
cs_f_max = 2.0
cs_f_min = 0.1
cs_AP_max = 0.3
cs_AP_min = 0.1
==================================================

============= Running time: 0th =============
Creating server and clients ...
Warning: Credit dataset Uci should have 2 classes. Auto-correcting from 10 to 2.
Auto-selected UciCreditNet for dataset Uci
UciCreditNet(
  (layers): Sequential(
    (0): Linear(in_features=23, out_features=32, bias=True)
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=32, out_features=16, bias=True)
    (5): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.2, inplace=False)
  )
  (fc): Linear(in_features=16, out_features=2, bias=True)
)
Warning: 'ditto' not supported. Using 'fedavg'.
  Client 0: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 1: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 2: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 3: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 4: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 5: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 6: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 7: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 8: Personalization enabled (mu=0.05, plocal_epochs=3)
  Client 9: Personalization enabled (mu=0.05, plocal_epochs=3)

============================================================
FedGpro: Federated Global Prototype Learning
============================================================
Join ratio / total clients: 1.0 / 10

Phase 1 Parameters (Max 20 rounds):
  Minimum threshold: 0.6
  Threshold formula:
    ACC(t-1) = (best_acc(t-1) + avg_acc(t-1)) / 2
    threshold(r) = ACC(t-1),                                       if r <= 9
    threshold(r) = max(0.66, ACC(t-1)*(1-0.05*floor((r-10)/5))), if r >= 10
  Training stages:
    - Round 1-10: Forced training (no early stop check, ensure VAE quality)
    - Round 11+: Early stop check + dynamic threshold with time decay
  Phase transition: 70% clients qualified OR 25 rounds reached

Phase 2 Parameters:
  Aggregation: fedavg
  Supported algorithms: fedavg, fedprox, fedscaffold
============================================================

Finished creating server and clients.

[Phase 1] Statistical Collection (Round 0)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.6600
  Best client accuracy (ACC(t)): 0.8427
  Global average accuracy (ACC(t)): 0.7255
  Client 6 meets threshold! Generating virtual data...
  Client 6: Privacy disabled, skipping baseline VAE training.
  Client 6: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.886)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 6: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 6: No noise added (privacy disabled).
  Client 0 meets threshold! Generating virtual data...
  Client 0: Privacy disabled, skipping baseline VAE training.
  Client 0: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅104/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 104/2250 candidates passed filter (avg confidence: 0.805)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 0: Generated 104/2250 high-quality samples (4.6% pass rate, strict threshold=0.80)
  Client 0: No noise added (privacy disabled).
  Client 1 meets threshold! Generating virtual data...
  Client 1: Privacy disabled, skipping baseline VAE training.
  Client 1: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.818)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 1: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 1: No noise added (privacy disabled).
  Client 9 meets threshold! Generating virtual data...
  Client 9: Privacy disabled, skipping baseline VAE training.
  Client 9: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.834)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 9: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 9: No noise added (privacy disabled).
  Client 4 meets threshold! Generating virtual data...
  Client 4: Privacy disabled, skipping baseline VAE training.
  Client 4: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.842)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 4: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 4: No noise added (privacy disabled).
  Client 8 meets threshold! Generating virtual data...
  Client 8: Privacy disabled, skipping baseline VAE training.
  Client 8: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅200/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 200/2250 candidates passed filter (avg confidence: 0.812)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 8: Generated 200/2250 high-quality samples (8.9% pass rate, strict threshold=0.80)
  Client 8: No noise added (privacy disabled).
  Client 3 meets threshold! Generating virtual data...
  Client 3: Privacy disabled, skipping baseline VAE training.
  Client 3: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅1/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 1/2250 candidates passed filter (avg confidence: 0.803)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 3: Generated 1/2250 high-quality samples (0.0% pass rate, strict threshold=0.80)
  Client 3: No noise added (privacy disabled).
  Newly qualified clients: [6, 0, 1, 9, 4, 8, 3]
  Total qualified clients: 7/10
  Virtual data pool size: 4805

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 0):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          活跃        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          活跃        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          活跃        
  Client 9   2250        1.0000        2250.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 1: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 0 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5620
Averaged Test Accuracy: 0.7255
Averaged Test AUC: 0.5231
Averaged Test Precision: 0.6131
Averaged Test Recall: 0.7255
Averaged Test F1-Score: 0.6440
Std Test Accuracy: 0.1128
Std Test AUC: 0.0450
------------------------------------------------------------
Round 0 time cost: 16.71s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 1)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7841
  Best client accuracy (ACC(t)): 0.8427
  Global average accuracy (ACC(t)): 0.7299

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 2: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 1 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5460
Averaged Test Accuracy: 0.7299
Averaged Test AUC: 0.5385
Averaged Test Precision: 0.6025
Averaged Test Recall: 0.7299
Averaged Test F1-Score: 0.6469
Std Test Accuracy: 0.1100
Std Test AUC: 0.0460
------------------------------------------------------------
Round 1 time cost: 14.86s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 2)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7863
  Best client accuracy (ACC(t)): 0.8413
  Global average accuracy (ACC(t)): 0.7303

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 3: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 2 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5719
Averaged Test Accuracy: 0.7303
Averaged Test AUC: 0.5554
Averaged Test Precision: 0.6646
Averaged Test Recall: 0.7303
Averaged Test F1-Score: 0.6830
Std Test Accuracy: 0.0968
Std Test AUC: 0.0748
------------------------------------------------------------
Round 2 time cost: 14.64s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 3)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7858
  Best client accuracy (ACC(t)): 0.8320
  Global average accuracy (ACC(t)): 0.7187

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 4: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 3 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.7019
Averaged Test Accuracy: 0.7187
Averaged Test AUC: 0.5618
Averaged Test Precision: 0.6853
Averaged Test Recall: 0.7187
Averaged Test F1-Score: 0.6869
Std Test Accuracy: 0.0816
Std Test AUC: 0.0861
------------------------------------------------------------
Round 3 time cost: 14.41s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 4)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7753
  Best client accuracy (ACC(t)): 0.8240
  Global average accuracy (ACC(t)): 0.7195

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 5: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 4 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.8121
Averaged Test Accuracy: 0.7195
Averaged Test AUC: 0.5740
Averaged Test Precision: 0.6921
Averaged Test Recall: 0.7195
Averaged Test F1-Score: 0.6948
Std Test Accuracy: 0.0708
Std Test AUC: 0.0983
------------------------------------------------------------
Round 4 time cost: 14.11s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7133)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7533)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7680)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.7093)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6933)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5907)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6413)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.8133)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7813)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7720)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7717
  Best client accuracy (ACC(t)): 0.8133
  Global average accuracy (ACC(t)): 0.7236

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 5):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          活跃        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          活跃        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          活跃        
  Client 9   2250        1.0000        2250.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 6: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 5 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.8895
Averaged Test Accuracy: 0.7236
Averaged Test AUC: 0.5873
Averaged Test Precision: 0.6975
Averaged Test Recall: 0.7236
Averaged Test F1-Score: 0.6984
Std Test Accuracy: 0.0650
Std Test AUC: 0.0981
------------------------------------------------------------
Round 5 time cost: 14.59s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 6)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7760)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6000)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7267)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7600)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.7987)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6960)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6800)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6800)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7747)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7520)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7685
  Best client accuracy (ACC(t)): 0.7987
  Global average accuracy (ACC(t)): 0.7244

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 7: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 6 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.9296
Averaged Test Accuracy: 0.7244
Averaged Test AUC: 0.5980
Averaged Test Precision: 0.7041
Averaged Test Recall: 0.7244
Averaged Test F1-Score: 0.7044
Std Test Accuracy: 0.0574
Std Test AUC: 0.1005
------------------------------------------------------------
Round 6 time cost: 14.67s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 7)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6573)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6933)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7600)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7653)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7613)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6840)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7120)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6080)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7720)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.7960)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7615
  Best client accuracy (ACC(t)): 0.7960
  Global average accuracy (ACC(t)): 0.7209

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 8: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 7 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.9731
Averaged Test Accuracy: 0.7209
Averaged Test AUC: 0.6039
Averaged Test Precision: 0.7056
Averaged Test Recall: 0.7209
Averaged Test F1-Score: 0.7020
Std Test Accuracy: 0.0569
Std Test AUC: 0.0972
------------------------------------------------------------
Round 7 time cost: 14.31s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 8)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7387)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7640)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7733)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.7227)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6960)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6400)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7747)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6853)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7160)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.8053)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7585
  Best client accuracy (ACC(t)): 0.8053
  Global average accuracy (ACC(t)): 0.7316

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 9: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 8 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.9674
Averaged Test Accuracy: 0.7316
Averaged Test AUC: 0.6138
Averaged Test Precision: 0.7119
Averaged Test Recall: 0.7316
Averaged Test F1-Score: 0.7135
Std Test Accuracy: 0.0472
Std Test AUC: 0.0968
------------------------------------------------------------
Round 8 time cost: 14.41s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 9)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7653)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7385
       第8轮: 0.7720 >= 0.7385 [+]
       第9轮: 0.7640 >= 0.7385 [+]
       第10轮: 0.7653 >= 0.7385 [+]
    [+] 条件(3): 波动率稳定 (0.0080 <= 0.0200)
       最近3轮: ['0.7720', '0.7640', '0.7653']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 8 reached early stopping criteria (Round 10):
    - Accuracy: 0.7653 (threshold: 0.7585)
    - Fluctuation: 0.0080 (last 3 rounds)
    - History: ['0.772', '0.764', '0.765']
  [Virtual Data] Generating and locking virtual data for client 8...
  [Mentor Mode] Client 8 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 8 early stopped at round 9
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6973)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第8轮: 0.6933 < 0.7385 [FAIL]
       第9轮: 0.6960 < 0.7385 [FAIL]
       第10轮: 0.6973 < 0.7385 [FAIL]
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6933)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第8轮: 0.6840 < 0.7385 [FAIL]
       第9轮: 0.7227 < 0.7385 [FAIL]
       第10轮: 0.6933 < 0.7385 [FAIL]
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7787)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7385
       第8轮: 0.7653 >= 0.7385 [+]
       第9轮: 0.7733 >= 0.7385 [+]
       第10轮: 0.7787 >= 0.7385 [+]
    [+] 条件(3): 波动率稳定 (0.0133 <= 0.0200)
       最近3轮: ['0.7653', '0.7733', '0.7787']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 1 reached early stopping criteria (Round 10):
    - Accuracy: 0.7787 (threshold: 0.7585)
    - Fluctuation: 0.0133 (last 3 rounds)
    - History: ['0.765', '0.773', '0.779']
  [Virtual Data] Generating and locking virtual data for client 1...
  [Mentor Mode] Client 1 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 1 early stopped at round 9
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6280)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第8轮: 0.6080 < 0.7385 [FAIL]
       第9轮: 0.6400 < 0.7385 [FAIL]
       第10轮: 0.6280 < 0.7385 [FAIL]
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7347)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第8轮: 0.7120 < 0.7385 [FAIL]
       第10轮: 0.7347 < 0.7385 [FAIL]
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7427)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第9轮: 0.7160 < 0.7385 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.8160)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7385
       第8轮: 0.7960 >= 0.7385 [+]
       第9轮: 0.8053 >= 0.7385 [+]
       第10轮: 0.8160 >= 0.7385 [+]
    [+] 条件(3): 波动率稳定 (0.0200 <= 0.0200)
       最近3轮: ['0.7960', '0.8053', '0.8160']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 6 reached early stopping criteria (Round 10):
    - Accuracy: 0.8160 (threshold: 0.7585)
    - Fluctuation: 0.0200 (last 3 rounds)
    - History: ['0.796', '0.805', '0.816']
  [Virtual Data] Generating and locking virtual data for client 6...
  [Mentor Mode] Client 6 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 6 early stopped at round 9
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6920)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7385 (ACC(t)=0.7585 - 0.02)
       第8轮: 0.6573 < 0.7385 [FAIL]
       第9轮: 0.6853 < 0.7385 [FAIL]
       第10轮: 0.6920 < 0.7385 [FAIL]
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7667)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7385
       第8轮: 0.7613 >= 0.7385 [+]
       第9轮: 0.7747 >= 0.7385 [+]
       第10轮: 0.7667 >= 0.7385 [+]
    [+] 条件(3): 波动率稳定 (0.0133 <= 0.0200)
       最近3轮: ['0.7613', '0.7747', '0.7667']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 9 reached early stopping criteria (Round 10):
    - Accuracy: 0.7667 (threshold: 0.7585)
    - Fluctuation: 0.0133 (last 3 rounds)
    - History: ['0.761', '0.775', '0.767']
  [Virtual Data] Generating and locking virtual data for client 9...
  [Mentor Mode] Client 9 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 9 early stopped at round 9
  Current threshold (based on ACC(t-1)): 0.7685
  Best client accuracy (ACC(t)): 0.8160
  Global average accuracy (ACC(t)): 0.7315
  Early-stopped clients: 4/10
  Active training clients: 6

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 9):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          早停        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          早停        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          早停        
  Client 9   2250        1.0000        2250.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C6=1.000 C8=1.000 C9=1.000 
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 10: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 9 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.9728
Averaged Test Accuracy: 0.7315
Averaged Test AUC: 0.6224
Averaged Test Precision: 0.7162
Averaged Test Recall: 0.7315
Averaged Test F1-Score: 0.7144
Std Test Accuracy: 0.0517
Std Test AUC: 0.0934
------------------------------------------------------------
Round 9 time cost: 14.43s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 10)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.7000)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.6960 < 0.7485 [FAIL]
       第10轮: 0.6973 < 0.7485 [FAIL]
       第11轮: 0.7000 < 0.7485 [FAIL]
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7360)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.7387 < 0.7485 [FAIL]
       第10轮: 0.7347 < 0.7485 [FAIL]
       第11轮: 0.7360 < 0.7485 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6560)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.6400 < 0.7485 [FAIL]
       第10轮: 0.6280 < 0.7485 [FAIL]
       第11轮: 0.6560 < 0.7485 [FAIL]
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7093)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.7160 < 0.7485 [FAIL]
       第10轮: 0.7427 < 0.7485 [FAIL]
       第11轮: 0.7093 < 0.7485 [FAIL]
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.7267)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.7227 < 0.7485 [FAIL]
       第10轮: 0.6933 < 0.7485 [FAIL]
       第11轮: 0.7267 < 0.7485 [FAIL]
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6947)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7485 (ACC(t)=0.7685 - 0.02)
       第9轮: 0.6853 < 0.7485 [FAIL]
       第10轮: 0.6920 < 0.7485 [FAIL]
       第11轮: 0.6947 < 0.7485 [FAIL]
  [Threshold Decay] Round 11: 衰减 0% (第0步)
    Base: 0.7737 → Decayed: 0.7737 → Final: 0.7737
  Current threshold (based on ACC(t-1)): 0.7737
  Best client accuracy (ACC(t)): 0.8000
  Global average accuracy (ACC(t)): 0.7341

  [Adaptive Decay] 权重衰减计算详情 (Round 11):
  当前全局准确率: 0.7341
  衰减强度λ: 0.5
    Client 8: 第10轮达标
      达标时准确率: 0.7315
      准确率提升Δ: +0.0027 → max(0,Δ)=0.0027
      衰减权重α_k: exp(-0.5×0.0027) = 0.9987
    Client 1: 第10轮达标
      达标时准确率: 0.7315
      准确率提升Δ: +0.0027 → max(0,Δ)=0.0027
      衰减权重α_k: exp(-0.5×0.0027) = 0.9987
    Client 6: 第10轮达标
      达标时准确率: 0.7315
      准确率提升Δ: +0.0027 → max(0,Δ)=0.0027
      衰减权重α_k: exp(-0.5×0.0027) = 0.9987
    Client 9: 第10轮达标
      达标时准确率: 0.7315
      准确率提升Δ: +0.0027 → max(0,Δ)=0.0027
      衰减权重α_k: exp(-0.5×0.0027) = 0.9987
  Early-stopped clients: 4/10
  Active training clients: 6

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 10):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1001          活跃        
  Client 1   2250        0.9987        2247.00         0.0999          早停        
  Client 2   2250        1.0000        2250.00         0.1001          活跃        
  Client 3   2250        1.0000        2250.00         0.1001          活跃        
  Client 4   2250        1.0000        2250.00         0.1001          活跃        
  Client 5   2250        1.0000        2250.00         0.1001          活跃        
  Client 6   2250        0.9987        2247.00         0.0999          早停        
  Client 7   2250        1.0000        2250.00         0.1001          活跃        
  Client 8   2250        0.9987        2247.00         0.0999          早停        
  Client 9   2250        0.9987        2247.00         0.0999          早停        
  --------------------------------------------------------------------------------
  总组合权重: 22488.01
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=0.999 C6=0.999 C8=0.999 C9=0.999 
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

================================================================================
[Phase Transition Check] Round 11 (Phase 1: 最多25轮)
================================================================================
达标要求: 7/10 客户端 (70%)
当前状态: 7/10 客户端达标

客户端详细状态:

[+] 已达标客户端 (7个):
  Client 6: 0.8000 [+]
  Client 9: 0.7920 [+]
  Client 1: 0.7680 [+]
  Client 8: 0.7587 [+]
  Client 3: 0.7360 [+]
  Client 4: 0.7267 [+]
  Client 0: 0.7093 [+]

[-] 未达标客户端 (3个):
  Client 7: 0.7000 (仍在训练中...)
  Client 2: 0.6947 (仍在训练中...)
  Client 5: 0.6560 (仍在训练中...)

当前阈值: 0.7737
平均准确率: 0.7341
最佳准确率: 0.8000
================================================================================

[>>] Phase Transition Triggered! (70% Threshold Strategy)
   Qualified clients: 7/10
   Required: 7 (70%)
   Remaining: 3 clients will join dynamically in Phase 2
   Phase 1 completed: 11 rounds (min: 10, max: 25)
================================================================================


============================================================
PHASE TRANSITION: Phase 1 → Phase 2
============================================================
Virtual data pool size: 4805
Phase 2 Algorithm: FEDAVG
Phase 2 Max Rounds: 50
============================================================

  [Algorithm Name] Updated: FedGpro → FedGpro-FedAvg
  Client 0: Phase 2 (already contributed virtual data)
  Client 1: Phase 2 (already contributed virtual data)
  Client 2: Phase 2 (can still contribute virtual data until round 20)
  Client 3: Phase 2 (already contributed virtual data)
  Client 4: Phase 2 (already contributed virtual data)
  Client 5: Phase 2 (can still contribute virtual data until round 20)
  Client 6: Phase 2 (already contributed virtual data)
  Client 7: Phase 2 (can still contribute virtual data until round 20)
  Client 8: Phase 2 (already contributed virtual data)
  Client 9: Phase 2 (already contributed virtual data)
[OK] Phase 2 initialized successfully!
   Algorithm: FEDAVG
   All clients enter Phase 2: 10 (100%)
   - Already contributed virtual data: 7 (70%)
   - Can still contribute (until round 20): 3 (30%)
   Virtual data pool size: 4805 samples
   Phase 1 will continue in parallel until round 20


============================================================
Round 10 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.9744
Averaged Test Accuracy: 0.7341
Averaged Test AUC: 0.6261
Averaged Test Precision: 0.7212
Averaged Test Recall: 0.7341
Averaged Test F1-Score: 0.7194
Std Test Accuracy: 0.0435
Std Test AUC: 0.0916

Evaluate personalized models
Averaged Train Loss (Personalized): 1.6013
Averaged Test Accuracy (Personalized): 0.5695
Averaged Test AUC (Personalized): 0.5146
Std Test Accuracy (Personalized): 0.1021
Std Test AUC (Personalized): 0.0830
------------------------------------------------------------
Round 10 time cost: 15.10s
------------------------------------------------------------

[Phase 2 - Round 11] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 11 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.6925
Averaged Test Accuracy: 0.7663
Averaged Test AUC: 0.6284
Averaged Test Precision: 0.7116
Averaged Test Recall: 0.7663
Averaged Test F1-Score: 0.7281
Std Test Accuracy: 0.0484
Std Test AUC: 0.1043

Evaluate personalized models
Averaged Train Loss (Personalized): 0.6185
Averaged Test Accuracy (Personalized): 0.7489
Averaged Test AUC (Personalized): 0.6122
Std Test Accuracy (Personalized): 0.0620
Std Test AUC (Personalized): 0.1025
------------------------------------------------------------
Round 11 time cost: 24.57s
------------------------------------------------------------

[Phase 2 - Round 12] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 12 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5983
Averaged Test Accuracy: 0.7775
Averaged Test AUC: 0.6628
Averaged Test Precision: 0.7341
Averaged Test Recall: 0.7775
Averaged Test F1-Score: 0.7328
Std Test Accuracy: 0.0526
Std Test AUC: 0.0946

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5588
Averaged Test Accuracy (Personalized): 0.7724
Averaged Test AUC (Personalized): 0.6616
Std Test Accuracy (Personalized): 0.0525
Std Test AUC (Personalized): 0.0856
------------------------------------------------------------
Round 12 time cost: 24.78s
------------------------------------------------------------

[Phase 2 - Round 13] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 13 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5494
Averaged Test Accuracy: 0.7775
Averaged Test AUC: 0.6806
Averaged Test Precision: 0.7519
Averaged Test Recall: 0.7775
Averaged Test F1-Score: 0.7277
Std Test Accuracy: 0.0570
Std Test AUC: 0.0900

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5257
Averaged Test Accuracy (Personalized): 0.7801
Averaged Test AUC (Personalized): 0.6860
Std Test Accuracy (Personalized): 0.0495
Std Test AUC (Personalized): 0.0764
------------------------------------------------------------
Round 13 time cost: 24.25s
------------------------------------------------------------

[Phase 2 - Round 14] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 14 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5302
Averaged Test Accuracy: 0.7740
Averaged Test AUC: 0.6928
Averaged Test Precision: 0.7261
Averaged Test Recall: 0.7740
Averaged Test F1-Score: 0.7199
Std Test Accuracy: 0.0592
Std Test AUC: 0.0836

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5086
Averaged Test Accuracy (Personalized): 0.7848
Averaged Test AUC (Personalized): 0.6977
Std Test Accuracy (Personalized): 0.0485
Std Test AUC (Personalized): 0.0739
------------------------------------------------------------
Round 14 time cost: 21.09s
------------------------------------------------------------

[Phase 2 - Round 15] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 15 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5164
Averaged Test Accuracy: 0.7705
Averaged Test AUC: 0.7004
Averaged Test Precision: 0.7242
Averaged Test Recall: 0.7705
Averaged Test F1-Score: 0.7147
Std Test Accuracy: 0.0613
Std Test AUC: 0.0806

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4999
Averaged Test Accuracy (Personalized): 0.7856
Averaged Test AUC (Personalized): 0.7054
Std Test Accuracy (Personalized): 0.0480
Std Test AUC (Personalized): 0.0733
------------------------------------------------------------
Round 15 time cost: 18.28s
------------------------------------------------------------

[Phase 2 - Round 16] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 16 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5083
Averaged Test Accuracy: 0.7667
Averaged Test AUC: 0.7038
Averaged Test Precision: 0.7125
Averaged Test Recall: 0.7667
Averaged Test F1-Score: 0.7077
Std Test Accuracy: 0.0657
Std Test AUC: 0.0768

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4921
Averaged Test Accuracy (Personalized): 0.7847
Averaged Test AUC (Personalized): 0.7110
Std Test Accuracy (Personalized): 0.0514
Std Test AUC (Personalized): 0.0709
------------------------------------------------------------
Round 16 time cost: 18.53s
------------------------------------------------------------

[Phase 2 - Round 17] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 17 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5046
Averaged Test Accuracy: 0.7668
Averaged Test AUC: 0.7086
Averaged Test Precision: 0.7170
Averaged Test Recall: 0.7668
Averaged Test F1-Score: 0.7060
Std Test Accuracy: 0.0654
Std Test AUC: 0.0747

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4879
Averaged Test Accuracy (Personalized): 0.7852
Averaged Test AUC (Personalized): 0.7126
Std Test Accuracy (Personalized): 0.0492
Std Test AUC (Personalized): 0.0718
------------------------------------------------------------
Round 17 time cost: 18.64s
------------------------------------------------------------

[Phase 2 - Round 18] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 18 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4996
Averaged Test Accuracy: 0.7609
Averaged Test AUC: 0.7127
Averaged Test Precision: 0.6941
Averaged Test Recall: 0.7609
Averaged Test F1-Score: 0.6950
Std Test Accuracy: 0.0696
Std Test AUC: 0.0730

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4817
Averaged Test Accuracy (Personalized): 0.7824
Averaged Test AUC (Personalized): 0.7137
Std Test Accuracy (Personalized): 0.0523
Std Test AUC (Personalized): 0.0707
------------------------------------------------------------
Round 18 time cost: 18.32s
------------------------------------------------------------

[Phase 2 - Round 19] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 19 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4952
Averaged Test Accuracy: 0.7639
Averaged Test AUC: 0.7169
Averaged Test Precision: 0.7101
Averaged Test Recall: 0.7639
Averaged Test F1-Score: 0.7010
Std Test Accuracy: 0.0680
Std Test AUC: 0.0720

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4799
Averaged Test Accuracy (Personalized): 0.7813
Averaged Test AUC (Personalized): 0.7209
Std Test Accuracy (Personalized): 0.0545
Std Test AUC (Personalized): 0.0686
------------------------------------------------------------
Round 19 time cost: 18.44s
------------------------------------------------------------

[Phase 2 - Round 20] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 20] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 20 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4959
Averaged Test Accuracy: 0.7609
Averaged Test AUC: 0.7177
Averaged Test Precision: 0.7232
Averaged Test Recall: 0.7609
Averaged Test F1-Score: 0.6937
Std Test Accuracy: 0.0711
Std Test AUC: 0.0706

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4760
Averaged Test Accuracy (Personalized): 0.7819
Averaged Test AUC (Personalized): 0.7233
Std Test Accuracy (Personalized): 0.0519
Std Test AUC (Personalized): 0.0669
------------------------------------------------------------
Round 20 time cost: 18.24s
------------------------------------------------------------

[Phase 2 - Round 21] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 21] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 21 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4925
Averaged Test Accuracy: 0.7633
Averaged Test AUC: 0.7206
Averaged Test Precision: 0.7371
Averaged Test Recall: 0.7633
Averaged Test F1-Score: 0.6986
Std Test Accuracy: 0.0684
Std Test AUC: 0.0696

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4739
Averaged Test Accuracy (Personalized): 0.7840
Averaged Test AUC (Personalized): 0.7220
Std Test Accuracy (Personalized): 0.0499
Std Test AUC (Personalized): 0.0680
------------------------------------------------------------
Round 21 time cost: 18.37s
------------------------------------------------------------

[Phase 2 - Round 22] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 22] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 22 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4913
Averaged Test Accuracy: 0.7624
Averaged Test AUC: 0.7236
Averaged Test Precision: 0.7340
Averaged Test Recall: 0.7624
Averaged Test F1-Score: 0.6973
Std Test Accuracy: 0.0693
Std Test AUC: 0.0681

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4722
Averaged Test Accuracy (Personalized): 0.7825
Averaged Test AUC (Personalized): 0.7242
Std Test Accuracy (Personalized): 0.0508
Std Test AUC (Personalized): 0.0666
------------------------------------------------------------
Round 22 time cost: 18.52s
------------------------------------------------------------

[Phase 2 - Round 23] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 23] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 23 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4858
Averaged Test Accuracy: 0.7671
Averaged Test AUC: 0.7263
Averaged Test Precision: 0.7276
Averaged Test Recall: 0.7671
Averaged Test F1-Score: 0.7052
Std Test Accuracy: 0.0641
Std Test AUC: 0.0672

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4694
Averaged Test Accuracy (Personalized): 0.7831
Averaged Test AUC (Personalized): 0.7280
Std Test Accuracy (Personalized): 0.0517
Std Test AUC (Personalized): 0.0669
------------------------------------------------------------
Round 23 time cost: 18.06s
------------------------------------------------------------

[Phase 2 - Round 24] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 24] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 24 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4840
Averaged Test Accuracy: 0.7677
Averaged Test AUC: 0.7293
Averaged Test Precision: 0.7318
Averaged Test Recall: 0.7677
Averaged Test F1-Score: 0.7062
Std Test Accuracy: 0.0642
Std Test AUC: 0.0657

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4688
Averaged Test Accuracy (Personalized): 0.7855
Averaged Test AUC (Personalized): 0.7283
Std Test Accuracy (Personalized): 0.0494
Std Test AUC (Personalized): 0.0659
------------------------------------------------------------
Round 24 time cost: 18.57s
------------------------------------------------------------

[Phase 2 - Round 25] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 25] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 4805
================================================================================

