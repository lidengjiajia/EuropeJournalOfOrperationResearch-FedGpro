==================================================
goal = label
device = cuda
device_id = 2
dataset = Xinwang
num_classes = 10
model = credit
batch_size = 128
local_learning_rate = 0.006
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
top_cnt = 100
local_epochs = 5
algorithm = FedGpro
join_ratio = 1.0
random_join_ratio = False
num_clients = 10
prev = 0
times = 5
eval_gap = 1
save_folder_name = system/models/Xinwang_FedGpro_label
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.08
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 4
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
first_stage_bound = 0
fedcross_alpha = 0.99
collaberative_model_select_strategy = 1
fedgpro_phase = 1
fedgpro_use_vae = True
fedgpro_use_prototype = True
fedgpro_epsilon = None
fedgpro_noise_type = None
fedgpro_delta = 1e-05
fedgpro_adaptive_noise = False
fedgpro_adaptive_strategy = balanced
fedgpro_utility_weight = 1.0
fedgpro_use_iadp = False
fedgpro_iadp_alpha = 0.3
fedgpro_iadp_importance_method = vae_contrast
fedgpro_iadp_importance_momentum = 0.9
fedgpro_iadp_privacy_priority = False
fedgpro_lambda_cls = 10.0
fedgpro_lambda_recon = 1.0
fedgpro_lambda_kl = 0.1
fedgpro_lambda_proto = 0.1
fedgpro_proto_momentum = 0.95
fedgpro_latent_dim = None
fedgpro_vae_lr = 0.001
fedgpro_proto_align_lr = 0.001
fedgpro_threshold_min = 0.6
fedgpro_phase_transition_threshold = 0.7
fedgpro_phase2_agg = ditto
fedgpro_phase2_rounds = 50
reserved_clients = []
gwo_alpha_decay = 0.015
pso_w_max = 0.9
pso_w_min = 0.4
pso_c1 = 2.0
pso_c2 = 2.0
pso_v_max = 0.5
cs_f_max = 2.0
cs_f_min = 0.1
cs_AP_max = 0.3
cs_AP_min = 0.1
==================================================

============= Running time: 0th =============
Creating server and clients ...
Warning: Credit dataset Xinwang should have 2 classes. Auto-correcting from 10 to 2.
Loaded Xinwang feature_dim=38 from config.json
Auto-selected XinwangCreditNet for dataset Xinwang
XinwangCreditNet(
  (feature_attention): FeatureAttention(
    (attention): Sequential(
      (0): Linear(in_features=38, out_features=4, bias=True)
      (1): ReLU()
      (2): Linear(in_features=4, out_features=38, bias=True)
      (3): Sigmoid()
    )
  )
  (hidden): Sequential(
    (0): Linear(in_features=38, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.15, inplace=False)
    (8): Linear(in_features=64, out_features=32, bias=True)
    (9): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU()
    (11): Dropout(p=0.15, inplace=False)
  )
  (fc): Linear(in_features=32, out_features=2, bias=True)
)
Warning: 'ditto' not supported. Using 'fedavg'.
  Client 0: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 1: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 2: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 3: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 4: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 5: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 6: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 7: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 8: Personalization enabled (mu=0.08, plocal_epochs=4)
  Client 9: Personalization enabled (mu=0.08, plocal_epochs=4)

============================================================
FedGpro: Federated Global Prototype Learning
============================================================
Join ratio / total clients: 1.0 / 10

Phase 1 Parameters (Max 20 rounds):
  Minimum threshold: 0.6
  Threshold formula:
    ACC(t-1) = (best_acc(t-1) + avg_acc(t-1)) / 2
    threshold(r) = ACC(t-1),                                       if r <= 9
    threshold(r) = max(0.66, ACC(t-1)*(1-0.05*floor((r-10)/5))), if r >= 10
  Training stages:
    - Round 1-10: Forced training (no early stop check, ensure VAE quality)
    - Round 11+: Early stop check + dynamic threshold with time decay
  Phase transition: 70% clients qualified OR 25 rounds reached

Phase 2 Parameters:
  Aggregation: fedavg
  Supported algorithms: fedavg, fedprox, fedscaffold
============================================================

Finished creating server and clients.

[Phase 1] Statistical Collection (Round 0)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.6600
  Best client accuracy (ACC(t)): 0.9485
  Global average accuracy (ACC(t)): 0.9125
  Client 5 meets threshold! Generating virtual data...
  Client 5: Privacy disabled, skipping baseline VAE training.
  Client 5: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.922)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 5: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 5: No noise added (privacy disabled).
  Client 8 meets threshold! Generating virtual data...
  Client 8: Privacy disabled, skipping baseline VAE training.
  Client 8: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.960)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 8: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 8: No noise added (privacy disabled).
  Client 3 meets threshold! Generating virtual data...
  Client 3: Privacy disabled, skipping baseline VAE training.
  Client 3: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.908)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 3: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 3: No noise added (privacy disabled).
  Client 1 meets threshold! Generating virtual data...
  Client 1: Privacy disabled, skipping baseline VAE training.
  Client 1: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.933)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 1: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 1: No noise added (privacy disabled).
  Client 6 meets threshold! Generating virtual data...
  Client 6: Privacy disabled, skipping baseline VAE training.
  Client 6: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.834)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 6: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 6: No noise added (privacy disabled).
  Client 2 meets threshold! Generating virtual data...
  Client 2: Privacy disabled, skipping baseline VAE training.
  Client 2: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.950)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 2: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 2: No noise added (privacy disabled).
  Client 4 meets threshold! Generating virtual data...
  Client 4: Privacy disabled, skipping baseline VAE training.
  Client 4: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.896)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 4: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 4: No noise added (privacy disabled).
  Client 0 meets threshold! Generating virtual data...
  Client 0: Privacy disabled, skipping baseline VAE training.
  Client 0: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 0/1340 candidates passed filter (avg confidence: nan)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 0: Generated 0/1341 high-quality samples (0.0% pass rate, strict threshold=0.80)
  Client 0: No noise added (privacy disabled).
  Client 9 meets threshold! Generating virtual data...
  Client 9: Privacy disabled, skipping baseline VAE training.
  Client 9: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.852)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 9: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 9: No noise added (privacy disabled).
  Client 7 meets threshold! Generating virtual data...
  Client 7: Privacy disabled, skipping baseline VAE training.
  Client 7: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.946)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 7: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 7: No noise added (privacy disabled).
  Newly qualified clients: [5, 8, 3, 1, 6, 2, 4, 0, 9, 7]
  Total qualified clients: 10/10
  Virtual data pool size: 6030

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 0):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          活跃        
  Client 2   1341        1.0000        1341.00         0.1000          活跃        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          活跃        
  Client 5   1341        1.0000        1341.00         0.1000          活跃        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          活跃        
  Client 8   1341        1.0000        1341.00         0.1000          活跃        
  Client 9   1341        1.0000        1341.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 1: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 0 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6323
Averaged Test Accuracy: 0.9125
Averaged Test AUC: 0.5763
Averaged Test Precision: 0.8384
Averaged Test Recall: 0.9125
Averaged Test F1-Score: 0.8734
Std Test Accuracy: 0.0413
Std Test AUC: 0.1377
------------------------------------------------------------
Round 0 time cost: 7.20s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 1)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9305
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 2: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 1 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6474
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6050
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1333
------------------------------------------------------------
Round 1 time cost: 5.40s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 2)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9141

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 3: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 2 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5856
Averaged Test Accuracy: 0.9141
Averaged Test AUC: 0.6212
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9141
Averaged Test F1-Score: 0.8742
Std Test Accuracy: 0.0413
Std Test AUC: 0.1180
------------------------------------------------------------
Round 2 time cost: 5.58s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 3)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9324
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 4: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 3 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6010
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6284
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1129
------------------------------------------------------------
Round 3 time cost: 5.32s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 4)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 5: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 4 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6180
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6287
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1209
------------------------------------------------------------
Round 4 time cost: 5.29s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 5):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          活跃        
  Client 2   1341        1.0000        1341.00         0.1000          活跃        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          活跃        
  Client 5   1341        1.0000        1341.00         0.1000          活跃        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          活跃        
  Client 8   1341        1.0000        1341.00         0.1000          活跃        
  Client 9   1341        1.0000        1341.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 6: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 5 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6396
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6379
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1490
------------------------------------------------------------
Round 5 time cost: 5.48s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 6)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 7: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 6 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6491
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6359
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1321
------------------------------------------------------------
Round 6 time cost: 5.26s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 7)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 8: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 7 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6194
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6426
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1391
------------------------------------------------------------
Round 7 time cost: 5.29s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 8)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 9: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 8 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.6670
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6524
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1487
------------------------------------------------------------
Round 8 time cost: 5.80s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 9)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9418 >= 0.9128 [+]
       第9轮: 0.9418 >= 0.9128 [+]
       第10轮: 0.9418 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9418', '0.9418', '0.9418']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 8 reached early stopping criteria (Round 10):
    - Accuracy: 0.9418 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.942', '0.942', '0.942']
  [Virtual Data] Generating and locking virtual data for client 8...
  [Mentor Mode] Client 8 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 8 early stopped at round 9
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.8054 < 0.9128 [FAIL]
       第9轮: 0.8054 < 0.9128 [FAIL]
       第10轮: 0.8054 < 0.9128 [FAIL]
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9396 >= 0.9128 [+]
       第9轮: 0.9396 >= 0.9128 [+]
       第10轮: 0.9396 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9396', '0.9396', '0.9396']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 4 reached early stopping criteria (Round 10):
    - Accuracy: 0.9396 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.940', '0.940', '0.940']
  [Virtual Data] Generating and locking virtual data for client 4...
  [Mentor Mode] Client 4 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 4 early stopped at round 9
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.8814 < 0.9128 [FAIL]
       第9轮: 0.8814 < 0.9128 [FAIL]
       第10轮: 0.8814 < 0.9128 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.9060 < 0.9128 [FAIL]
       第9轮: 0.9060 < 0.9128 [FAIL]
       第10轮: 0.9060 < 0.9128 [FAIL]
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9217 >= 0.9128 [+]
       第9轮: 0.9217 >= 0.9128 [+]
       第10轮: 0.9217 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9217', '0.9217', '0.9217']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 2 reached early stopping criteria (Round 10):
    - Accuracy: 0.9217 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.922', '0.922', '0.922']
  [Virtual Data] Generating and locking virtual data for client 2...
  [Mentor Mode] Client 2 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 2 early stopped at round 9
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9508 >= 0.9128 [+]
       第9轮: 0.9508 >= 0.9128 [+]
       第10轮: 0.9508 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9508', '0.9508', '0.9508']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 1 reached early stopping criteria (Round 10):
    - Accuracy: 0.9508 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.951', '0.951', '0.951']
  [Virtual Data] Generating and locking virtual data for client 1...
  [Mentor Mode] Client 1 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 1 early stopped at round 9
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9396 >= 0.9128 [+]
       第9轮: 0.9396 >= 0.9128 [+]
       第10轮: 0.9396 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9396', '0.9396', '0.9396']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 9 reached early stopping criteria (Round 10):
    - Accuracy: 0.9396 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.940', '0.940', '0.940']
  [Virtual Data] Generating and locking virtual data for client 9...
  [Mentor Mode] Client 9 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 9 early stopped at round 9
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9441 >= 0.9128 [+]
       第9轮: 0.9441 >= 0.9128 [+]
       第10轮: 0.9441 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9441', '0.9441', '0.9441']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 7 reached early stopping criteria (Round 10):
    - Accuracy: 0.9441 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.944', '0.944', '0.944']
  [Virtual Data] Generating and locking virtual data for client 7...
  [Mentor Mode] Client 7 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 7 early stopped at round 9
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9172 >= 0.9128 [+]
       第9轮: 0.9172 >= 0.9128 [+]
       第10轮: 0.9172 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9172', '0.9172', '0.9172']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 5 reached early stopping criteria (Round 10):
    - Accuracy: 0.9172 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.917', '0.917', '0.917']
  [Virtual Data] Generating and locking virtual data for client 5...
  [Mentor Mode] Client 5 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 5 early stopped at round 9
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148
  Early-stopped clients: 7/10
  Active training clients: 3

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 9):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          早停        
  Client 2   1341        1.0000        1341.00         0.1000          早停        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          早停        
  Client 5   1341        1.0000        1341.00         0.1000          早停        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          早停        
  Client 8   1341        1.0000        1341.00         0.1000          早停        
  Client 9   1341        1.0000        1341.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C2=1.000 C4=1.000 C5=1.000 C7=1.000 ... (7 total)
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 10: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 9 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.7079
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6498
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1448
------------------------------------------------------------
Round 9 time cost: 5.50s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 10)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.8814 < 0.9128 [FAIL]
       第10轮: 0.8814 < 0.9128 [FAIL]
       第11轮: 0.8814 < 0.9128 [FAIL]
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.8054 < 0.9128 [FAIL]
       第10轮: 0.8054 < 0.9128 [FAIL]
       第11轮: 0.8054 < 0.9128 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.9060 < 0.9128 [FAIL]
       第10轮: 0.9060 < 0.9128 [FAIL]
       第11轮: 0.9060 < 0.9128 [FAIL]
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  [Threshold Decay] Round 11: 衰减 0% (第0步)
    Base: 0.9328 → Decayed: 0.9328 → Final: 0.9328
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [Adaptive Decay] 权重衰减计算详情 (Round 11):
  当前全局准确率: 0.9148
  衰减强度λ: 0.5
    Client 8: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 4: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 2: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 1: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 9: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 7: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 5: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
  Early-stopped clients: 7/10
  Active training clients: 3

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 10):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          早停        
  Client 2   1341        1.0000        1341.00         0.1000          早停        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          早停        
  Client 5   1341        1.0000        1341.00         0.1000          早停        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          早停        
  Client 8   1341        1.0000        1341.00         0.1000          早停        
  Client 9   1341        1.0000        1341.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C2=1.000 C4=1.000 C5=1.000 C7=1.000 ... (7 total)
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

================================================================================
[Phase Transition Check] Round 11 (Phase 1: 最多25轮)
================================================================================
达标要求: 7/10 客户端 (70%)
当前状态: 10/10 客户端达标

客户端详细状态:

[+] 已达标客户端 (10个):
  Client 1: 0.9508 [+]
  Client 7: 0.9441 [+]
  Client 8: 0.9418 [+]
  Client 4: 0.9396 [+]
  Client 9: 0.9396 [+]
  Client 2: 0.9217 [+]
  Client 5: 0.9172 [+]
  Client 6: 0.9060 [+]
  Client 3: 0.8814 [+]
  Client 0: 0.8054 [+]

当前阈值: 0.9328
平均准确率: 0.9148
最佳准确率: 0.9508
================================================================================

[>>] Phase Transition Triggered! (70% Threshold Strategy)
   Qualified clients: 10/10
   Required: 7 (70%)
   Remaining: 0 clients will join dynamically in Phase 2
   Phase 1 completed: 11 rounds (min: 10, max: 25)
================================================================================


============================================================
PHASE TRANSITION: Phase 1 → Phase 2
============================================================
Virtual data pool size: 6030
Phase 2 Algorithm: FEDAVG
Phase 2 Max Rounds: 50
============================================================

  [Algorithm Name] Updated: FedGpro → FedGpro-FedAvg
  Client 0: Phase 2 (already contributed virtual data)
  Client 1: Phase 2 (already contributed virtual data)
  Client 2: Phase 2 (already contributed virtual data)
  Client 3: Phase 2 (already contributed virtual data)
  Client 4: Phase 2 (already contributed virtual data)
  Client 5: Phase 2 (already contributed virtual data)
  Client 6: Phase 2 (already contributed virtual data)
  Client 7: Phase 2 (already contributed virtual data)
  Client 8: Phase 2 (already contributed virtual data)
  Client 9: Phase 2 (already contributed virtual data)
[OK] Phase 2 initialized successfully!
   Algorithm: FEDAVG
   All clients enter Phase 2: 10 (100%)
   - Already contributed virtual data: 10 (100%)
   - Can still contribute (until round 20): 0 (0%)
   Virtual data pool size: 6030 samples
   Phase 1 will continue in parallel until round 20


============================================================
Round 10 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.7488
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6503
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1444

Evaluate personalized models
Averaged Train Loss (Personalized): 2.4745
Averaged Test Accuracy (Personalized): 0.5273
Averaged Test AUC (Personalized): 0.3790
Std Test Accuracy (Personalized): 0.1575
Std Test AUC (Personalized): 0.1425
------------------------------------------------------------
Round 10 time cost: 6.08s
------------------------------------------------------------

[Phase 2 - Round 11] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 11 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.7234
Averaged Test Accuracy: 0.7043
Averaged Test AUC: 0.5838
Averaged Test Precision: 0.8595
Averaged Test Recall: 0.7043
Averaged Test F1-Score: 0.7642
Std Test Accuracy: 0.0744
Std Test AUC: 0.0731

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5649
Averaged Test Accuracy (Personalized): 0.7414
Averaged Test AUC (Personalized): 0.7025
Std Test Accuracy (Personalized): 0.1065
Std Test AUC (Personalized): 0.1141
------------------------------------------------------------
Round 11 time cost: 18.64s
------------------------------------------------------------

[Phase 2 - Round 12] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 12 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3463
Averaged Test Accuracy: 0.8879
Averaged Test AUC: 0.6357
Averaged Test Precision: 0.8582
Averaged Test Recall: 0.8879
Averaged Test F1-Score: 0.8723
Std Test Accuracy: 0.0455
Std Test AUC: 0.1059

Evaluate personalized models
Averaged Train Loss (Personalized): 0.3043
Averaged Test Accuracy (Personalized): 0.8749
Averaged Test AUC (Personalized): 0.7286
Std Test Accuracy (Personalized): 0.0461
Std Test AUC (Personalized): 0.1184
------------------------------------------------------------
Round 12 time cost: 18.94s
------------------------------------------------------------

[Phase 2 - Round 13] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 13 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3079
Averaged Test Accuracy: 0.9081
Averaged Test AUC: 0.6879
Averaged Test Precision: 0.8630
Averaged Test Recall: 0.9081
Averaged Test F1-Score: 0.8819
Std Test Accuracy: 0.0411
Std Test AUC: 0.1086

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2440
Averaged Test Accuracy (Personalized): 0.9121
Averaged Test AUC (Personalized): 0.7642
Std Test Accuracy (Personalized): 0.0273
Std Test AUC (Personalized): 0.1096
------------------------------------------------------------
Round 13 time cost: 18.91s
------------------------------------------------------------

[Phase 2 - Round 14] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 14 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3045
Averaged Test Accuracy: 0.9056
Averaged Test AUC: 0.7005
Averaged Test Precision: 0.8417
Averaged Test Recall: 0.9056
Averaged Test F1-Score: 0.8710
Std Test Accuracy: 0.0421
Std Test AUC: 0.1138

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2213
Averaged Test Accuracy (Personalized): 0.9210
Averaged Test AUC (Personalized): 0.7847
Std Test Accuracy (Personalized): 0.0218
Std Test AUC (Personalized): 0.1053
------------------------------------------------------------
Round 14 time cost: 19.03s
------------------------------------------------------------

[Phase 2 - Round 15] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 15 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2926
Averaged Test Accuracy: 0.9087
Averaged Test AUC: 0.6984
Averaged Test Precision: 0.8584
Averaged Test Recall: 0.9087
Averaged Test F1-Score: 0.8790
Std Test Accuracy: 0.0491
Std Test AUC: 0.1246

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2068
Averaged Test Accuracy (Personalized): 0.9340
Averaged Test AUC (Personalized): 0.7961
Std Test Accuracy (Personalized): 0.0224
Std Test AUC (Personalized): 0.1032
------------------------------------------------------------
Round 15 time cost: 18.96s
------------------------------------------------------------

[Phase 2 - Round 16] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 16 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2801
Averaged Test Accuracy: 0.9125
Averaged Test AUC: 0.7089
Averaged Test Precision: 0.8469
Averaged Test Recall: 0.9125
Averaged Test F1-Score: 0.8750
Std Test Accuracy: 0.0412
Std Test AUC: 0.1187

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1984
Averaged Test Accuracy (Personalized): 0.9360
Averaged Test AUC (Personalized): 0.8108
Std Test Accuracy (Personalized): 0.0195
Std Test AUC (Personalized): 0.0989
------------------------------------------------------------
Round 16 time cost: 17.93s
------------------------------------------------------------

[Phase 2 - Round 17] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 17 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2815
Averaged Test Accuracy: 0.9078
Averaged Test AUC: 0.7078
Averaged Test Precision: 0.8460
Averaged Test Recall: 0.9078
Averaged Test F1-Score: 0.8748
Std Test Accuracy: 0.0489
Std Test AUC: 0.1260

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1917
Averaged Test Accuracy (Personalized): 0.9383
Averaged Test AUC (Personalized): 0.8190
Std Test Accuracy (Personalized): 0.0191
Std Test AUC (Personalized): 0.0973
------------------------------------------------------------
Round 17 time cost: 17.82s
------------------------------------------------------------

[Phase 2 - Round 18] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 18 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2797
Averaged Test Accuracy: 0.9125
Averaged Test AUC: 0.7022
Averaged Test Precision: 0.8447
Averaged Test Recall: 0.9125
Averaged Test F1-Score: 0.8742
Std Test Accuracy: 0.0413
Std Test AUC: 0.1244

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1873
Averaged Test Accuracy (Personalized): 0.9398
Averaged Test AUC (Personalized): 0.8267
Std Test Accuracy (Personalized): 0.0257
Std Test AUC (Personalized): 0.0950
------------------------------------------------------------
Round 18 time cost: 17.97s
------------------------------------------------------------

[Phase 2 - Round 19] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 19 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2712
Averaged Test Accuracy: 0.9130
Averaged Test AUC: 0.7050
Averaged Test Precision: 0.8520
Averaged Test Recall: 0.9130
Averaged Test F1-Score: 0.8764
Std Test Accuracy: 0.0423
Std Test AUC: 0.1288

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1814
Averaged Test Accuracy (Personalized): 0.9407
Averaged Test AUC (Personalized): 0.8369
Std Test Accuracy (Personalized): 0.0255
Std Test AUC (Personalized): 0.0928
------------------------------------------------------------
Round 19 time cost: 18.06s
------------------------------------------------------------

[Phase 2 - Round 20] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 20 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2639
Averaged Test Accuracy: 0.9105
Averaged Test AUC: 0.7072
Averaged Test Precision: 0.8485
Averaged Test Recall: 0.9105
Averaged Test F1-Score: 0.8749
Std Test Accuracy: 0.0457
Std Test AUC: 0.1340

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1756
Averaged Test Accuracy (Personalized): 0.9391
Averaged Test AUC (Personalized): 0.8430
Std Test Accuracy (Personalized): 0.0266
Std Test AUC (Personalized): 0.0914
------------------------------------------------------------
Round 20 time cost: 16.87s
------------------------------------------------------------

[Phase 2 - Round 21] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 21 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2597
Averaged Test Accuracy: 0.9136
Averaged Test AUC: 0.7264
Averaged Test Precision: 0.8416
Averaged Test Recall: 0.9136
Averaged Test F1-Score: 0.8744
Std Test Accuracy: 0.0419
Std Test AUC: 0.1302

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1718
Averaged Test Accuracy (Personalized): 0.9398
Averaged Test AUC (Personalized): 0.8481
Std Test Accuracy (Personalized): 0.0264
Std Test AUC (Personalized): 0.0916
------------------------------------------------------------
Round 21 time cost: 14.60s
------------------------------------------------------------

[Phase 2 - Round 22] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 22 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2610
Averaged Test Accuracy: 0.9152
Averaged Test AUC: 0.7206
Averaged Test Precision: 0.8582
Averaged Test Recall: 0.9152
Averaged Test F1-Score: 0.8783
Std Test Accuracy: 0.0418
Std Test AUC: 0.1401

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1681
Averaged Test Accuracy (Personalized): 0.9400
Averaged Test AUC (Personalized): 0.8502
Std Test Accuracy (Personalized): 0.0264
Std Test AUC (Personalized): 0.0902
------------------------------------------------------------
Round 22 time cost: 14.08s
------------------------------------------------------------

[Phase 2 - Round 23] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 23 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2583
Averaged Test Accuracy: 0.9121
Averaged Test AUC: 0.7087
Averaged Test Precision: 0.8549
Averaged Test Recall: 0.9121
Averaged Test F1-Score: 0.8783
Std Test Accuracy: 0.0472
Std Test AUC: 0.1265

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1669
Averaged Test Accuracy (Personalized): 0.9398
Averaged Test AUC (Personalized): 0.8562
Std Test Accuracy (Personalized): 0.0263
Std Test AUC (Personalized): 0.0876
------------------------------------------------------------
Round 23 time cost: 13.83s
------------------------------------------------------------

[Phase 2 - Round 24] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 24 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2512
Averaged Test Accuracy: 0.9213
Averaged Test AUC: 0.7218
Averaged Test Precision: 0.8690
Averaged Test Recall: 0.9213
Averaged Test F1-Score: 0.8879
Std Test Accuracy: 0.0264
Std Test AUC: 0.1282

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1618
Averaged Test Accuracy (Personalized): 0.9400
Averaged Test AUC (Personalized): 0.8648
Std Test Accuracy (Personalized): 0.0258
Std Test AUC (Personalized): 0.0869
------------------------------------------------------------
Round 24 time cost: 13.90s
------------------------------------------------------------

[Phase 2 - Round 25] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 25 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2518
Averaged Test Accuracy: 0.9145
Averaged Test AUC: 0.7216
Averaged Test Precision: 0.8562
Averaged Test Recall: 0.9145
Averaged Test F1-Score: 0.8795
Std Test Accuracy: 0.0419
Std Test AUC: 0.1214

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1609
Averaged Test Accuracy (Personalized): 0.9398
Averaged Test AUC (Personalized): 0.8650
Std Test Accuracy (Personalized): 0.0257
Std Test AUC (Personalized): 0.0854
------------------------------------------------------------
Round 25 time cost: 13.90s
------------------------------------------------------------

[Phase 2 - Round 26] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 26 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2451
Averaged Test Accuracy: 0.9145
Averaged Test AUC: 0.7337
Averaged Test Precision: 0.8562
Averaged Test Recall: 0.9145
Averaged Test F1-Score: 0.8795
Std Test Accuracy: 0.0419
Std Test AUC: 0.1202

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1583
Averaged Test Accuracy (Personalized): 0.9409
Averaged Test AUC (Personalized): 0.8692
Std Test Accuracy (Personalized): 0.0261
Std Test AUC (Personalized): 0.0855
------------------------------------------------------------
Round 26 time cost: 14.10s
------------------------------------------------------------

[Phase 2 - Round 27] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 27 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2469
Averaged Test Accuracy: 0.9128
Averaged Test AUC: 0.7360
Averaged Test Precision: 0.8541
Averaged Test Recall: 0.9128
Averaged Test F1-Score: 0.8785
Std Test Accuracy: 0.0467
Std Test AUC: 0.1235

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1555
Averaged Test Accuracy (Personalized): 0.9409
Averaged Test AUC (Personalized): 0.8730
Std Test Accuracy (Personalized): 0.0269
Std Test AUC (Personalized): 0.0843
------------------------------------------------------------
Round 27 time cost: 13.86s
------------------------------------------------------------

[Phase 2 - Round 28] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 28 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2453
Averaged Test Accuracy: 0.9181
Averaged Test AUC: 0.7427
Averaged Test Precision: 0.8665
Averaged Test Recall: 0.9181
Averaged Test F1-Score: 0.8821
Std Test Accuracy: 0.0336
Std Test AUC: 0.1182

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1532
Averaged Test Accuracy (Personalized): 0.9416
Averaged Test AUC (Personalized): 0.8760
Std Test Accuracy (Personalized): 0.0266
Std Test AUC (Personalized): 0.0826
------------------------------------------------------------
Round 28 time cost: 13.69s
------------------------------------------------------------

[Phase 2 - Round 29] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 29 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2459
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.7412
Averaged Test Precision: 0.8447
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8750
Std Test Accuracy: 0.0418
Std Test AUC: 0.1195

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1512
Averaged Test Accuracy (Personalized): 0.9416
Averaged Test AUC (Personalized): 0.8763
Std Test Accuracy (Personalized): 0.0273
Std Test AUC (Personalized): 0.0832
------------------------------------------------------------
Round 29 time cost: 13.68s
------------------------------------------------------------

[Phase 2 - Round 30] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 30 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2445
Averaged Test Accuracy: 0.9217
Averaged Test AUC: 0.7380
Averaged Test Precision: 0.8691
Averaged Test Recall: 0.9217
Averaged Test F1-Score: 0.8881
Std Test Accuracy: 0.0255
Std Test AUC: 0.1151

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1479
Averaged Test Accuracy (Personalized): 0.9416
Averaged Test AUC (Personalized): 0.8807
Std Test Accuracy (Personalized): 0.0271
Std Test AUC (Personalized): 0.0819
------------------------------------------------------------
Round 30 time cost: 13.98s
------------------------------------------------------------

[Phase 2 - Round 31] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 31 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2445
Averaged Test Accuracy: 0.9186
Averaged Test AUC: 0.7445
Averaged Test Precision: 0.8785
Averaged Test Recall: 0.9186
Averaged Test F1-Score: 0.8827
Std Test Accuracy: 0.0331
Std Test AUC: 0.1037

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1482
Averaged Test Accuracy (Personalized): 0.9432
Averaged Test AUC (Personalized): 0.8827
Std Test Accuracy (Personalized): 0.0274
Std Test AUC (Personalized): 0.0810
------------------------------------------------------------
Round 31 time cost: 13.66s
------------------------------------------------------------

[Phase 2 - Round 32] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 32 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2409
Averaged Test Accuracy: 0.9183
Averaged Test AUC: 0.7449
Averaged Test Precision: 0.8665
Averaged Test Recall: 0.9183
Averaged Test F1-Score: 0.8822
Std Test Accuracy: 0.0333
Std Test AUC: 0.1123

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1462
Averaged Test Accuracy (Personalized): 0.9421
Averaged Test AUC (Personalized): 0.8853
Std Test Accuracy (Personalized): 0.0268
Std Test AUC (Personalized): 0.0798
------------------------------------------------------------
Round 32 time cost: 13.57s
------------------------------------------------------------

[Phase 2 - Round 33] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 33 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2417
Averaged Test Accuracy: 0.9150
Averaged Test AUC: 0.7437
Averaged Test Precision: 0.8563
Averaged Test Recall: 0.9150
Averaged Test F1-Score: 0.8797
Std Test Accuracy: 0.0418
Std Test AUC: 0.1095

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1463
Averaged Test Accuracy (Personalized): 0.9427
Averaged Test AUC (Personalized): 0.8863
Std Test Accuracy (Personalized): 0.0264
Std Test AUC (Personalized): 0.0794
------------------------------------------------------------
Round 33 time cost: 14.10s
------------------------------------------------------------

[Phase 2 - Round 34] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 34 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2422
Averaged Test Accuracy: 0.9114
Averaged Test AUC: 0.7443
Averaged Test Precision: 0.8380
Averaged Test Recall: 0.9114
Averaged Test F1-Score: 0.8729
Std Test Accuracy: 0.0507
Std Test AUC: 0.1106

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1442
Averaged Test Accuracy (Personalized): 0.9427
Averaged Test AUC (Personalized): 0.8882
Std Test Accuracy (Personalized): 0.0267
Std Test AUC (Personalized): 0.0783
------------------------------------------------------------
Round 34 time cost: 13.82s
------------------------------------------------------------

[Phase 2 - Round 35] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 35 | Phase 2
============================================================

Evaluate global model
