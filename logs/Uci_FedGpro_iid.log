==================================================
goal = iid
device = cuda
device_id = 1
dataset = Uci
num_classes = 10
model = credit
batch_size = 64
local_learning_rate = 0.007
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
top_cnt = 100
local_epochs = 5
algorithm = FedGpro
join_ratio = 1.0
random_join_ratio = False
num_clients = 10
prev = 0
times = 5
eval_gap = 1
save_folder_name = system/models/Uci_FedGpro_iid
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.01
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 2
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
first_stage_bound = 0
fedcross_alpha = 0.99
collaberative_model_select_strategy = 1
fedgpro_phase = 1
fedgpro_use_vae = True
fedgpro_use_prototype = True
fedgpro_epsilon = None
fedgpro_noise_type = None
fedgpro_delta = 1e-05
fedgpro_adaptive_noise = False
fedgpro_adaptive_strategy = balanced
fedgpro_utility_weight = 1.0
fedgpro_use_iadp = False
fedgpro_iadp_alpha = 0.3
fedgpro_iadp_importance_method = vae_contrast
fedgpro_iadp_importance_momentum = 0.9
fedgpro_iadp_privacy_priority = False
fedgpro_lambda_cls = 10.0
fedgpro_lambda_recon = 1.0
fedgpro_lambda_kl = 0.1
fedgpro_lambda_proto = 0.1
fedgpro_proto_momentum = 0.95
fedgpro_latent_dim = None
fedgpro_vae_lr = 0.001
fedgpro_proto_align_lr = 0.001
fedgpro_threshold_min = 0.6
fedgpro_phase_transition_threshold = 0.7
fedgpro_phase2_agg = ditto
fedgpro_phase2_rounds = 50
reserved_clients = []
gwo_alpha_decay = 0.015
pso_w_max = 0.9
pso_w_min = 0.4
pso_c1 = 2.0
pso_c2 = 2.0
pso_v_max = 0.5
cs_f_max = 2.0
cs_f_min = 0.1
cs_AP_max = 0.3
cs_AP_min = 0.1
==================================================

============= Running time: 0th =============
Creating server and clients ...
Warning: Credit dataset Uci should have 2 classes. Auto-correcting from 10 to 2.
Auto-selected UciCreditNet for dataset Uci
UciCreditNet(
  (layers): Sequential(
    (0): Linear(in_features=23, out_features=32, bias=True)
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.4, inplace=False)
    (4): Linear(in_features=32, out_features=16, bias=True)
    (5): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.2, inplace=False)
  )
  (fc): Linear(in_features=16, out_features=2, bias=True)
)
Warning: 'ditto' not supported. Using 'fedavg'.
  Client 0: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 1: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 2: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 3: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 4: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 5: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 6: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 7: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 8: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 9: Personalization enabled (mu=0.01, plocal_epochs=2)

============================================================
FedGpro: Federated Global Prototype Learning
============================================================
Join ratio / total clients: 1.0 / 10

Phase 1 Parameters (Max 20 rounds):
  Minimum threshold: 0.6
  Threshold formula:
    ACC(t-1) = (best_acc(t-1) + avg_acc(t-1)) / 2
    threshold(r) = ACC(t-1),                                       if r <= 9
    threshold(r) = max(0.66, ACC(t-1)*(1-0.05*floor((r-10)/5))), if r >= 10
  Training stages:
    - Round 1-10: Forced training (no early stop check, ensure VAE quality)
    - Round 11+: Early stop check + dynamic threshold with time decay
  Phase transition: 70% clients qualified OR 25 rounds reached

Phase 2 Parameters:
  Aggregation: fedavg
  Supported algorithms: fedavg, fedprox, fedscaffold
============================================================

Finished creating server and clients.

[Phase 1] Statistical Collection (Round 0)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.6600
  Best client accuracy (ACC(t)): 0.8427
  Global average accuracy (ACC(t)): 0.7240
  Client 6 meets threshold! Generating virtual data...
  Client 6: Privacy disabled, skipping baseline VAE training.
  Client 6: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.877)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 6: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 6: No noise added (privacy disabled).
  Client 8 meets threshold! Generating virtual data...
  Client 8: Privacy disabled, skipping baseline VAE training.
  Client 8: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.845)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 8: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 8: No noise added (privacy disabled).
  Client 4 meets threshold! Generating virtual data...
  Client 4: Privacy disabled, skipping baseline VAE training.
  Client 4: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.834)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 4: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 4: No noise added (privacy disabled).
  Client 3 meets threshold! Generating virtual data...
  Client 3: Privacy disabled, skipping baseline VAE training.
  Client 3: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅3/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 3/2250 candidates passed filter (avg confidence: 0.840)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 3: Generated 3/2250 high-quality samples (0.1% pass rate, strict threshold=0.80)
  Client 3: No noise added (privacy disabled).
  Client 0 meets threshold! Generating virtual data...
  Client 0: Privacy disabled, skipping baseline VAE training.
  Client 0: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.839)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 0: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 0: No noise added (privacy disabled).
  Client 1 meets threshold! Generating virtual data...
  Client 1: Privacy disabled, skipping baseline VAE training.
  Client 1: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.829)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 1: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 1: No noise added (privacy disabled).
  Client 9 meets threshold! Generating virtual data...
  Client 9: Privacy disabled, skipping baseline VAE training.
  Client 9: Collecting latent distribution from real data...
    [OK] Class 0: 1125个高质量样本达标 (threshold=0.80)
    Class 0: 1125/2250 candidates passed filter (avg confidence: 0.815)
    [WARNING] Class 1: 仅0/1125样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/2250 candidates passed filter (avg confidence: nan)
  Client 9: Generated 1125/2250 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 9: No noise added (privacy disabled).
  Newly qualified clients: [6, 8, 4, 3, 0, 1, 9]
  Total qualified clients: 7/10
  Virtual data pool size: 6753

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 0):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          活跃        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          活跃        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          活跃        
  Client 9   2250        1.0000        2250.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 1: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 0 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5662
Averaged Test Accuracy: 0.7240
Averaged Test AUC: 0.4979
Averaged Test Precision: 0.6225
Averaged Test Recall: 0.7240
Averaged Test F1-Score: 0.6418
Std Test Accuracy: 0.1213
Std Test AUC: 0.0587
------------------------------------------------------------
Round 0 time cost: 16.49s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 1)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7833
  Best client accuracy (ACC(t)): 0.8427
  Global average accuracy (ACC(t)): 0.7208

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 2: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 1 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5493
Averaged Test Accuracy: 0.7208
Averaged Test AUC: 0.5199
Averaged Test Precision: 0.5963
Averaged Test Recall: 0.7208
Averaged Test F1-Score: 0.6431
Std Test Accuracy: 0.1195
Std Test AUC: 0.0578
------------------------------------------------------------
Round 1 time cost: 14.42s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 2)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7817
  Best client accuracy (ACC(t)): 0.8427
  Global average accuracy (ACC(t)): 0.7253

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 3: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 2 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5966
Averaged Test Accuracy: 0.7253
Averaged Test AUC: 0.5285
Averaged Test Precision: 0.6528
Averaged Test Recall: 0.7253
Averaged Test F1-Score: 0.6774
Std Test Accuracy: 0.0931
Std Test AUC: 0.0688
------------------------------------------------------------
Round 2 time cost: 14.43s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 3)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7840
  Best client accuracy (ACC(t)): 0.8187
  Global average accuracy (ACC(t)): 0.6940

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 4: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 3 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.7652
Averaged Test Accuracy: 0.6940
Averaged Test AUC: 0.5279
Averaged Test Precision: 0.6659
Averaged Test Recall: 0.6940
Averaged Test F1-Score: 0.6688
Std Test Accuracy: 0.0894
Std Test AUC: 0.0826
------------------------------------------------------------
Round 3 time cost: 14.51s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 4)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.7563
  Best client accuracy (ACC(t)): 0.7947
  Global average accuracy (ACC(t)): 0.6987

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 5: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 4 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.8976
Averaged Test Accuracy: 0.6987
Averaged Test AUC: 0.5422
Averaged Test Precision: 0.6788
Averaged Test Recall: 0.6987
Averaged Test F1-Score: 0.6793
Std Test Accuracy: 0.0750
Std Test AUC: 0.0950
------------------------------------------------------------
Round 4 time cost: 14.35s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6827)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6613)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.6987)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.7933)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7587)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7693)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6520)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7213)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7333)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5427)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7467
  Best client accuracy (ACC(t)): 0.7933
  Global average accuracy (ACC(t)): 0.7013

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 5):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          活跃        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          活跃        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          活跃        
  Client 9   2250        1.0000        2250.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 6: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 5 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.9748
Averaged Test Accuracy: 0.7013
Averaged Test AUC: 0.5567
Averaged Test Precision: 0.6852
Averaged Test Recall: 0.7013
Averaged Test F1-Score: 0.6841
Std Test Accuracy: 0.0688
Std Test AUC: 0.1002
------------------------------------------------------------
Round 5 time cost: 14.57s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 6)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7653)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6987)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7267)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5720)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.8013)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7547)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7160)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6640)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7253)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6773)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7473
  Best client accuracy (ACC(t)): 0.8013
  Global average accuracy (ACC(t)): 0.7101

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 7: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 6 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 1.0042
Averaged Test Accuracy: 0.7101
Averaged Test AUC: 0.5694
Averaged Test Precision: 0.6909
Averaged Test Recall: 0.7101
Averaged Test F1-Score: 0.6929
Std Test Accuracy: 0.0603
Std Test AUC: 0.1029
------------------------------------------------------------
Round 6 time cost: 14.48s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 7)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6640)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7587)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6627)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7587)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7307)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6987)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5813)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.7880)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7533)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.6880)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7557
  Best client accuracy (ACC(t)): 0.7880
  Global average accuracy (ACC(t)): 0.7084

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 8: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 7 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 1.0252
Averaged Test Accuracy: 0.7084
Averaged Test AUC: 0.5794
Averaged Test Precision: 0.6937
Averaged Test Recall: 0.7084
Averaged Test F1-Score: 0.6942
Std Test Accuracy: 0.0588
Std Test AUC: 0.1029
------------------------------------------------------------
Round 7 time cost: 14.03s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 8)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7507)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6707)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.7920)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.7067)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5627)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7680)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6893)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7307)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6840)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7560)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.7482
  Best client accuracy (ACC(t)): 0.7920
  Global average accuracy (ACC(t)): 0.7111

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 9: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 8 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 1.0427
Averaged Test Accuracy: 0.7111
Averaged Test AUC: 0.5894
Averaged Test Precision: 0.6956
Averaged Test Recall: 0.7111
Averaged Test F1-Score: 0.6952
Std Test Accuracy: 0.0622
Std Test AUC: 0.0961
------------------------------------------------------------
Round 8 time cost: 13.71s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 9)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.7680)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7282
       第8轮: 0.7533 >= 0.7282 [+]
       第9轮: 0.7680 >= 0.7282 [+]
       第10轮: 0.7680 >= 0.7282 [+]
    [+] 条件(3): 波动率稳定 (0.0147 <= 0.0200)
       最近3轮: ['0.7533', '0.7680', '0.7680']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 1 reached early stopping criteria (Round 10):
    - Accuracy: 0.7680 (threshold: 0.7482)
    - Fluctuation: 0.0147 (last 3 rounds)
    - History: ['0.753', '0.768', '0.768']
  [Virtual Data] Generating and locking virtual data for client 1...
  [Mentor Mode] Client 1 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 1 early stopped at round 9
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.6440)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第8轮: 0.6880 < 0.7282 [FAIL]
       第9轮: 0.7067 < 0.7282 [FAIL]
       第10轮: 0.6440 < 0.7282 [FAIL]
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.7480)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7282
       第8轮: 0.7587 >= 0.7282 [+]
       第9轮: 0.7560 >= 0.7282 [+]
       第10轮: 0.7480 >= 0.7282 [+]
    [+] 条件(3): 波动率稳定 (0.0107 <= 0.0200)
       最近3轮: ['0.7587', '0.7560', '0.7480']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 9 reached early stopping criteria (Round 10):
    - Accuracy: 0.7480 (threshold: 0.7482)
    - Fluctuation: 0.0107 (last 3 rounds)
    - History: ['0.759', '0.756', '0.748']
  [Virtual Data] Generating and locking virtual data for client 9...
  [Mentor Mode] Client 9 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 9 early stopped at round 9
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.6893)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第8轮: 0.6987 < 0.7282 [FAIL]
       第9轮: 0.6893 < 0.7282 [FAIL]
       第10轮: 0.6893 < 0.7282 [FAIL]
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6800)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第8轮: 0.6627 < 0.7282 [FAIL]
       第9轮: 0.6840 < 0.7282 [FAIL]
       第10轮: 0.6800 < 0.7282 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.8040)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7282
       第8轮: 0.7880 >= 0.7282 [+]
       第9轮: 0.7920 >= 0.7282 [+]
       第10轮: 0.8040 >= 0.7282 [+]
    [+] 条件(3): 波动率稳定 (0.0160 <= 0.0200)
       最近3轮: ['0.7880', '0.7920', '0.8040']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 6 reached early stopping criteria (Round 10):
    - Accuracy: 0.8040 (threshold: 0.7482)
    - Fluctuation: 0.0160 (last 3 rounds)
    - History: ['0.788', '0.792', '0.804']
  [Virtual Data] Generating and locking virtual data for client 6...
  [Mentor Mode] Client 6 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 6 early stopped at round 9
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6787)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第8轮: 0.6640 < 0.7282 [FAIL]
       第9轮: 0.6707 < 0.7282 [FAIL]
       第10轮: 0.6787 < 0.7282 [FAIL]
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7267)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第10轮: 0.7267 < 0.7282 [FAIL]
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.5987)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7282 (ACC(t)=0.7482 - 0.02)
       第8轮: 0.5813 < 0.7282 [FAIL]
       第9轮: 0.5627 < 0.7282 [FAIL]
       第10轮: 0.5987 < 0.7282 [FAIL]
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.7680)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.7282
       第8轮: 0.7587 >= 0.7282 [+]
       第9轮: 0.7507 >= 0.7282 [+]
       第10轮: 0.7680 >= 0.7282 [+]
    [+] 条件(3): 波动率稳定 (0.0173 <= 0.0200)
       最近3轮: ['0.7587', '0.7507', '0.7680']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 8 reached early stopping criteria (Round 10):
    - Accuracy: 0.7680 (threshold: 0.7482)
    - Fluctuation: 0.0173 (last 3 rounds)
    - History: ['0.759', '0.751', '0.768']
  [Virtual Data] Generating and locking virtual data for client 8...
  [Mentor Mode] Client 8 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 8 early stopped at round 9
  Current threshold (based on ACC(t-1)): 0.7515
  Best client accuracy (ACC(t)): 0.8040
  Global average accuracy (ACC(t)): 0.7105
  Early-stopped clients: 4/10
  Active training clients: 6

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 9):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1000          活跃        
  Client 1   2250        1.0000        2250.00         0.1000          早停        
  Client 2   2250        1.0000        2250.00         0.1000          活跃        
  Client 3   2250        1.0000        2250.00         0.1000          活跃        
  Client 4   2250        1.0000        2250.00         0.1000          活跃        
  Client 5   2250        1.0000        2250.00         0.1000          活跃        
  Client 6   2250        1.0000        2250.00         0.1000          早停        
  Client 7   2250        1.0000        2250.00         0.1000          活跃        
  Client 8   2250        1.0000        2250.00         0.1000          早停        
  Client 9   2250        1.0000        2250.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 22500.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C6=1.000 C8=1.000 C9=1.000 
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 10: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 9 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 1.0436
Averaged Test Accuracy: 0.7105
Averaged Test AUC: 0.5953
Averaged Test Precision: 0.7029
Averaged Test Recall: 0.7105
Averaged Test F1-Score: 0.6985
Std Test Accuracy: 0.0603
Std Test AUC: 0.0952
------------------------------------------------------------
Round 9 time cost: 14.30s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 10)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.6053)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.5627 < 0.7315 [FAIL]
       第10轮: 0.5987 < 0.7315 [FAIL]
       第11轮: 0.6053 < 0.7315 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.7333)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.7307 < 0.7315 [FAIL]
       第10轮: 0.7267 < 0.7315 [FAIL]
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.7147)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.6893 < 0.7315 [FAIL]
       第10轮: 0.6893 < 0.7315 [FAIL]
       第11轮: 0.7147 < 0.7315 [FAIL]
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.6853)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.7067 < 0.7315 [FAIL]
       第10轮: 0.6440 < 0.7315 [FAIL]
       第11轮: 0.6853 < 0.7315 [FAIL]
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.6907)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.6840 < 0.7315 [FAIL]
       第10轮: 0.6800 < 0.7315 [FAIL]
       第11轮: 0.6907 < 0.7315 [FAIL]
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.6800)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.7315 (ACC(t)=0.7515 - 0.02)
       第9轮: 0.6707 < 0.7315 [FAIL]
       第10轮: 0.6787 < 0.7315 [FAIL]
       第11轮: 0.6800 < 0.7315 [FAIL]
  [Threshold Decay] Round 11: 衰减 0% (第0步)
    Base: 0.7573 → Decayed: 0.7573 → Final: 0.7573
  Current threshold (based on ACC(t-1)): 0.7573
  Best client accuracy (ACC(t)): 0.8187
  Global average accuracy (ACC(t)): 0.7213

  [Adaptive Decay] 权重衰减计算详情 (Round 11):
  当前全局准确率: 0.7213
  衰减强度λ: 0.5
    Client 1: 第10轮达标
      达标时准确率: 0.7105
      准确率提升Δ: +0.0108 → max(0,Δ)=0.0108
      衰减权重α_k: exp(-0.5×0.0108) = 0.9946
    Client 9: 第10轮达标
      达标时准确率: 0.7105
      准确率提升Δ: +0.0108 → max(0,Δ)=0.0108
      衰减权重α_k: exp(-0.5×0.0108) = 0.9946
    Client 6: 第10轮达标
      达标时准确率: 0.7105
      准确率提升Δ: +0.0108 → max(0,Δ)=0.0108
      衰减权重α_k: exp(-0.5×0.0108) = 0.9946
    Client 8: 第10轮达标
      达标时准确率: 0.7105
      准确率提升Δ: +0.0108 → max(0,Δ)=0.0108
      衰减权重α_k: exp(-0.5×0.0108) = 0.9946
  Early-stopped clients: 4/10
  Active training clients: 6

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 10):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   2250        1.0000        2250.00         0.1002          活跃        
  Client 1   2250        0.9946        2237.88         0.0997          早停        
  Client 2   2250        1.0000        2250.00         0.1002          活跃        
  Client 3   2250        1.0000        2250.00         0.1002          活跃        
  Client 4   2250        1.0000        2250.00         0.1002          活跃        
  Client 5   2250        1.0000        2250.00         0.1002          活跃        
  Client 6   2250        0.9946        2237.88         0.0997          早停        
  Client 7   2250        1.0000        2250.00         0.1002          活跃        
  Client 8   2250        0.9946        2237.88         0.0997          早停        
  Client 9   2250        0.9946        2237.88         0.0997          早停        
  --------------------------------------------------------------------------------
  总组合权重: 22451.53
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=0.995 C6=0.995 C8=0.995 C9=0.995 
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

================================================================================
[Phase Transition Check] Round 11 (Phase 1: 最多25轮)
================================================================================
达标要求: 7/10 客户端 (70%)
当前状态: 7/10 客户端达标

客户端详细状态:

[+] 已达标客户端 (7个):
  Client 6: 0.8187 [+]
  Client 1: 0.7693 [+]
  Client 8: 0.7587 [+]
  Client 9: 0.7573 [+]
  Client 3: 0.7333 [+]
  Client 4: 0.6907 [+]
  Client 0: 0.6853 [+]

[-] 未达标客户端 (3个):
  Client 2: 0.7147 (仍在训练中...)
  Client 7: 0.6800 (仍在训练中...)
  Client 5: 0.6053 (仍在训练中...)

当前阈值: 0.7573
平均准确率: 0.7213
最佳准确率: 0.8187
================================================================================

[>>] Phase Transition Triggered! (70% Threshold Strategy)
   Qualified clients: 7/10
   Required: 7 (70%)
   Remaining: 3 clients will join dynamically in Phase 2
   Phase 1 completed: 11 rounds (min: 10, max: 25)
================================================================================


============================================================
PHASE TRANSITION: Phase 1 → Phase 2
============================================================
Virtual data pool size: 6753
Phase 2 Algorithm: FEDAVG
Phase 2 Max Rounds: 50
============================================================

  [Algorithm Name] Updated: FedGpro → FedGpro-FedAvg
  Client 0: Phase 2 (already contributed virtual data)
  Client 1: Phase 2 (already contributed virtual data)
  Client 2: Phase 2 (can still contribute virtual data until round 20)
  Client 3: Phase 2 (already contributed virtual data)
  Client 4: Phase 2 (already contributed virtual data)
  Client 5: Phase 2 (can still contribute virtual data until round 20)
  Client 6: Phase 2 (already contributed virtual data)
  Client 7: Phase 2 (can still contribute virtual data until round 20)
  Client 8: Phase 2 (already contributed virtual data)
  Client 9: Phase 2 (already contributed virtual data)
[OK] Phase 2 initialized successfully!
   Algorithm: FEDAVG
   All clients enter Phase 2: 10 (100%)
   - Already contributed virtual data: 7 (70%)
   - Can still contribute (until round 20): 3 (30%)
   Virtual data pool size: 6753 samples
   Phase 1 will continue in parallel until round 20


============================================================
Round 10 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 1.0378
Averaged Test Accuracy: 0.7213
Averaged Test AUC: 0.6011
Averaged Test Precision: 0.7074
Averaged Test Recall: 0.7213
Averaged Test F1-Score: 0.7074
Std Test Accuracy: 0.0566
Std Test AUC: 0.0950

Evaluate personalized models
Averaged Train Loss (Personalized): 1.6013
Averaged Test Accuracy (Personalized): 0.5695
Averaged Test AUC (Personalized): 0.5146
Std Test Accuracy (Personalized): 0.1021
Std Test AUC (Personalized): 0.0830
------------------------------------------------------------
Round 10 time cost: 15.17s
------------------------------------------------------------

[Phase 2 - Round 11] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 11 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.6892
Averaged Test Accuracy: 0.7713
Averaged Test AUC: 0.6320
Averaged Test Precision: 0.7134
Averaged Test Recall: 0.7713
Averaged Test F1-Score: 0.7302
Std Test Accuracy: 0.0477
Std Test AUC: 0.1040

Evaluate personalized models
Averaged Train Loss (Personalized): 0.6702
Averaged Test Accuracy (Personalized): 0.7216
Averaged Test AUC (Personalized): 0.5830
Std Test Accuracy (Personalized): 0.0579
Std Test AUC (Personalized): 0.1043
------------------------------------------------------------
Round 11 time cost: 29.09s
------------------------------------------------------------

[Phase 2 - Round 12] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 12 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5973
Averaged Test Accuracy: 0.7769
Averaged Test AUC: 0.6675
Averaged Test Precision: 0.7373
Averaged Test Recall: 0.7769
Averaged Test F1-Score: 0.7303
Std Test Accuracy: 0.0547
Std Test AUC: 0.0936

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5923
Averaged Test Accuracy (Personalized): 0.7640
Averaged Test AUC (Personalized): 0.6326
Std Test Accuracy (Personalized): 0.0518
Std Test AUC (Personalized): 0.0988
------------------------------------------------------------
Round 12 time cost: 29.44s
------------------------------------------------------------

[Phase 2 - Round 13] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 13 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5552
Averaged Test Accuracy: 0.7737
Averaged Test AUC: 0.6838
Averaged Test Precision: 0.7393
Averaged Test Recall: 0.7737
Averaged Test F1-Score: 0.7219
Std Test Accuracy: 0.0574
Std Test AUC: 0.0870

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5589
Averaged Test Accuracy (Personalized): 0.7735
Averaged Test AUC (Personalized): 0.6591
Std Test Accuracy (Personalized): 0.0537
Std Test AUC (Personalized): 0.0869
------------------------------------------------------------
Round 13 time cost: 27.76s
------------------------------------------------------------

[Phase 2 - Round 14] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 14 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5260
Averaged Test Accuracy: 0.7707
Averaged Test AUC: 0.6935
Averaged Test Precision: 0.7202
Averaged Test Recall: 0.7707
Averaged Test F1-Score: 0.7167
Std Test Accuracy: 0.0610
Std Test AUC: 0.0808

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5325
Averaged Test Accuracy (Personalized): 0.7776
Averaged Test AUC (Personalized): 0.6805
Std Test Accuracy (Personalized): 0.0494
Std Test AUC (Personalized): 0.0789
------------------------------------------------------------
Round 14 time cost: 22.31s
------------------------------------------------------------

[Phase 2 - Round 15] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 15 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5178
Averaged Test Accuracy: 0.7660
Averaged Test AUC: 0.6998
Averaged Test Precision: 0.7104
Averaged Test Recall: 0.7660
Averaged Test F1-Score: 0.7056
Std Test Accuracy: 0.0652
Std Test AUC: 0.0793

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5199
Averaged Test Accuracy (Personalized): 0.7805
Averaged Test AUC (Personalized): 0.6870
Std Test Accuracy (Personalized): 0.0500
Std Test AUC (Personalized): 0.0756
------------------------------------------------------------
Round 15 time cost: 21.72s
------------------------------------------------------------

[Phase 2 - Round 16] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 16 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5120
Averaged Test Accuracy: 0.7627
Averaged Test AUC: 0.7047
Averaged Test Precision: 0.7318
Averaged Test Recall: 0.7627
Averaged Test F1-Score: 0.6998
Std Test Accuracy: 0.0687
Std Test AUC: 0.0760

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5084
Averaged Test Accuracy (Personalized): 0.7821
Averaged Test AUC (Personalized): 0.6961
Std Test Accuracy (Personalized): 0.0483
Std Test AUC (Personalized): 0.0745
------------------------------------------------------------
Round 16 time cost: 21.71s
------------------------------------------------------------

[Phase 2 - Round 17] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 17 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5065
Averaged Test Accuracy: 0.7612
Averaged Test AUC: 0.7105
Averaged Test Precision: 0.7144
Averaged Test Recall: 0.7612
Averaged Test F1-Score: 0.6947
Std Test Accuracy: 0.0698
Std Test AUC: 0.0748

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5040
Averaged Test Accuracy (Personalized): 0.7813
Averaged Test AUC (Personalized): 0.6996
Std Test Accuracy (Personalized): 0.0487
Std Test AUC (Personalized): 0.0726
------------------------------------------------------------
Round 17 time cost: 21.54s
------------------------------------------------------------

[Phase 2 - Round 18] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 18 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5033
Averaged Test Accuracy: 0.7585
Averaged Test AUC: 0.7136
Averaged Test Precision: 0.7052
Averaged Test Recall: 0.7585
Averaged Test F1-Score: 0.6908
Std Test Accuracy: 0.0729
Std Test AUC: 0.0731

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4972
Averaged Test Accuracy (Personalized): 0.7849
Averaged Test AUC (Personalized): 0.7047
Std Test Accuracy (Personalized): 0.0480
Std Test AUC (Personalized): 0.0723
------------------------------------------------------------
Round 18 time cost: 21.46s
------------------------------------------------------------

[Phase 2 - Round 19] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 19 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4989
Averaged Test Accuracy: 0.7661
Averaged Test AUC: 0.7151
Averaged Test Precision: 0.7273
Averaged Test Recall: 0.7661
Averaged Test F1-Score: 0.7021
Std Test Accuracy: 0.0652
Std Test AUC: 0.0718

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4931
Averaged Test Accuracy (Personalized): 0.7837
Averaged Test AUC (Personalized): 0.7078
Std Test Accuracy (Personalized): 0.0508
Std Test AUC (Personalized): 0.0712
------------------------------------------------------------
Round 19 time cost: 21.56s
------------------------------------------------------------

[Phase 2 - Round 20] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 20] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 6753
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 20 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4979
Averaged Test Accuracy: 0.7644
Averaged Test AUC: 0.7181
Averaged Test Precision: 0.7384
Averaged Test Recall: 0.7644
Averaged Test F1-Score: 0.6979
Std Test Accuracy: 0.0689
Std Test AUC: 0.0693

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4884
Averaged Test Accuracy (Personalized): 0.7859
Averaged Test AUC (Personalized): 0.7114
Std Test Accuracy (Personalized): 0.0487
Std Test AUC (Personalized): 0.0719
------------------------------------------------------------
Round 20 time cost: 21.58s
------------------------------------------------------------

[Phase 2 - Round 21] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 21] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 6753
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 21 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4980
Averaged Test Accuracy: 0.7653
Averaged Test AUC: 0.7191
Averaged Test Precision: 0.7361
Averaged Test Recall: 0.7653
Averaged Test F1-Score: 0.7009
Std Test Accuracy: 0.0679
Std Test AUC: 0.0696

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4864
Averaged Test Accuracy (Personalized): 0.7853
Averaged Test AUC (Personalized): 0.7130
Std Test Accuracy (Personalized): 0.0503
Std Test AUC (Personalized): 0.0708
------------------------------------------------------------
Round 21 time cost: 21.49s
------------------------------------------------------------

[Phase 2 - Round 22] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 22] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 6753
================================================================================

  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 22 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.4905
Averaged Test Accuracy: 0.7652
Averaged Test AUC: 0.7235
Averaged Test Precision: 0.7235
Averaged Test Recall: 0.7652
Averaged Test F1-Score: 0.7027
Std Test Accuracy: 0.0657
Std Test AUC: 0.0683

Evaluate personalized models
Averaged Train Loss (Personalized): 0.4828
Averaged Test Accuracy (Personalized): 0.7851
Averaged Test AUC (Personalized): 0.7160
Std Test Accuracy (Personalized): 0.0506
Std Test AUC (Personalized): 0.0699
------------------------------------------------------------
Round 22 time cost: 21.41s
------------------------------------------------------------

[Phase 2 - Round 23] Algorithm: FEDAVG
  Phase 2 clients: 7 | Phase 1 clients (training): 3

================================================================================
[Round 23] Phase 1 Training Window CLOSED (20 rounds limit reached)
================================================================================
Finalizing Phase 1: 3 clients did not contribute virtual data
Note: These clients will continue Phase 2 training but NOT contribute to virtual data pool

  Client 2: contributes_virtual_data permanently set to False
  Client 5: contributes_virtual_data permanently set to False
  Client 7: contributes_virtual_data permanently set to False

[OK] Phase 1 finalized!
   - Virtual data contributors: 7/10
   - Non-contributors (permanent): 3
   - Virtual data pool size (final): 6753
================================================================================

