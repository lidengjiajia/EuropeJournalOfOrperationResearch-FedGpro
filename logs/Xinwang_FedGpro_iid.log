==================================================
goal = iid
device = cuda
device_id = 3
dataset = Xinwang
num_classes = 10
model = credit
batch_size = 128
local_learning_rate = 0.006
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 100
top_cnt = 100
local_epochs = 5
algorithm = FedGpro
join_ratio = 1.0
random_join_ratio = False
num_clients = 10
prev = 0
times = 5
eval_gap = 1
save_folder_name = system/models/Xinwang_FedGpro_iid
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.01
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 2
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
first_stage_bound = 0
fedcross_alpha = 0.99
collaberative_model_select_strategy = 1
fedgpro_phase = 1
fedgpro_use_vae = True
fedgpro_use_prototype = True
fedgpro_epsilon = None
fedgpro_noise_type = None
fedgpro_delta = 1e-05
fedgpro_adaptive_noise = False
fedgpro_adaptive_strategy = balanced
fedgpro_utility_weight = 1.0
fedgpro_use_iadp = False
fedgpro_iadp_alpha = 0.3
fedgpro_iadp_importance_method = vae_contrast
fedgpro_iadp_importance_momentum = 0.9
fedgpro_iadp_privacy_priority = False
fedgpro_lambda_cls = 10.0
fedgpro_lambda_recon = 1.0
fedgpro_lambda_kl = 0.1
fedgpro_lambda_proto = 0.1
fedgpro_proto_momentum = 0.95
fedgpro_latent_dim = None
fedgpro_vae_lr = 0.001
fedgpro_proto_align_lr = 0.001
fedgpro_threshold_min = 0.6
fedgpro_phase_transition_threshold = 0.7
fedgpro_phase2_agg = ditto
fedgpro_phase2_rounds = 50
reserved_clients = []
gwo_alpha_decay = 0.015
pso_w_max = 0.9
pso_w_min = 0.4
pso_c1 = 2.0
pso_c2 = 2.0
pso_v_max = 0.5
cs_f_max = 2.0
cs_f_min = 0.1
cs_AP_max = 0.3
cs_AP_min = 0.1
==================================================

============= Running time: 0th =============
Creating server and clients ...
Warning: Credit dataset Xinwang should have 2 classes. Auto-correcting from 10 to 2.
Loaded Xinwang feature_dim=38 from config.json
Auto-selected XinwangCreditNet for dataset Xinwang
XinwangCreditNet(
  (feature_attention): FeatureAttention(
    (attention): Sequential(
      (0): Linear(in_features=38, out_features=4, bias=True)
      (1): ReLU()
      (2): Linear(in_features=4, out_features=38, bias=True)
      (3): Sigmoid()
    )
  )
  (hidden): Sequential(
    (0): Linear(in_features=38, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.3, inplace=False)
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.15, inplace=False)
    (8): Linear(in_features=64, out_features=32, bias=True)
    (9): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU()
    (11): Dropout(p=0.15, inplace=False)
  )
  (fc): Linear(in_features=32, out_features=2, bias=True)
)
Warning: 'ditto' not supported. Using 'fedavg'.
  Client 0: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 1: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 2: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 3: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 4: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 5: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 6: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 7: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 8: Personalization enabled (mu=0.01, plocal_epochs=2)
  Client 9: Personalization enabled (mu=0.01, plocal_epochs=2)

============================================================
FedGpro: Federated Global Prototype Learning
============================================================
Join ratio / total clients: 1.0 / 10

Phase 1 Parameters (Max 20 rounds):
  Minimum threshold: 0.6
  Threshold formula:
    ACC(t-1) = (best_acc(t-1) + avg_acc(t-1)) / 2
    threshold(r) = ACC(t-1),                                       if r <= 9
    threshold(r) = max(0.66, ACC(t-1)*(1-0.05*floor((r-10)/5))), if r >= 10
  Training stages:
    - Round 1-10: Forced training (no early stop check, ensure VAE quality)
    - Round 11+: Early stop check + dynamic threshold with time decay
  Phase transition: 70% clients qualified OR 25 rounds reached

Phase 2 Parameters:
  Aggregation: fedavg
  Supported algorithms: fedavg, fedprox, fedscaffold
============================================================

Finished creating server and clients.

[Phase 1] Statistical Collection (Round 0)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.6600
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9119
  Client 0 meets threshold! Generating virtual data...
  Client 0: Privacy disabled, skipping baseline VAE training.
  Client 0: Collecting latent distribution from real data...
    [WARNING] Class 0: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 0: 0/1340 candidates passed filter (avg confidence: nan)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 0: Generated 0/1341 high-quality samples (0.0% pass rate, strict threshold=0.80)
  Client 0: No noise added (privacy disabled).
  Client 3 meets threshold! Generating virtual data...
  Client 3: Privacy disabled, skipping baseline VAE training.
  Client 3: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.891)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 3: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 3: No noise added (privacy disabled).
  Client 4 meets threshold! Generating virtual data...
  Client 4: Privacy disabled, skipping baseline VAE training.
  Client 4: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.946)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 4: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 4: No noise added (privacy disabled).
  Client 6 meets threshold! Generating virtual data...
  Client 6: Privacy disabled, skipping baseline VAE training.
  Client 6: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.894)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 6: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 6: No noise added (privacy disabled).
  Client 7 meets threshold! Generating virtual data...
  Client 7: Privacy disabled, skipping baseline VAE training.
  Client 7: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.948)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 7: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 7: No noise added (privacy disabled).
  Client 5 meets threshold! Generating virtual data...
  Client 5: Privacy disabled, skipping baseline VAE training.
  Client 5: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.929)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 5: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 5: No noise added (privacy disabled).
  Client 9 meets threshold! Generating virtual data...
  Client 9: Privacy disabled, skipping baseline VAE training.
  Client 9: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.842)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 9: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 9: No noise added (privacy disabled).
  Client 8 meets threshold! Generating virtual data...
  Client 8: Privacy disabled, skipping baseline VAE training.
  Client 8: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.970)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 8: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 8: No noise added (privacy disabled).
  Client 1 meets threshold! Generating virtual data...
  Client 1: Privacy disabled, skipping baseline VAE training.
  Client 1: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.959)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 1: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 1: No noise added (privacy disabled).
  Client 2 meets threshold! Generating virtual data...
  Client 2: Privacy disabled, skipping baseline VAE training.
  Client 2: Collecting latent distribution from real data...
    [OK] Class 0: 670个高质量样本达标 (threshold=0.80)
    Class 0: 670/1340 candidates passed filter (avg confidence: 0.941)
    [WARNING] Class 1: 仅0/670样本达标 (threshold=0.80), 宁缺毋滥，不补充低质量数据
    Class 1: 0/1340 candidates passed filter (avg confidence: nan)
  Client 2: Generated 670/1341 high-quality samples (50.0% pass rate, strict threshold=0.80)
  Client 2: No noise added (privacy disabled).
  Newly qualified clients: [0, 3, 4, 6, 7, 5, 9, 8, 1, 2]
  Total qualified clients: 10/10
  Virtual data pool size: 6030

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 0):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          活跃        
  Client 2   1341        1.0000        1341.00         0.1000          活跃        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          活跃        
  Client 5   1341        1.0000        1341.00         0.1000          活跃        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          活跃        
  Client 8   1341        1.0000        1341.00         0.1000          活跃        
  Client 9   1341        1.0000        1341.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 1: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 0 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4516
Averaged Test Accuracy: 0.9119
Averaged Test AUC: 0.5616
Averaged Test Precision: 0.8383
Averaged Test Recall: 0.9119
Averaged Test F1-Score: 0.8731
Std Test Accuracy: 0.0411
Std Test AUC: 0.1378
------------------------------------------------------------
Round 0 time cost: 7.20s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 1)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9313
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9145

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 2: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 1 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4776
Averaged Test Accuracy: 0.9145
Averaged Test AUC: 0.6059
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9145
Averaged Test F1-Score: 0.8744
Std Test Accuracy: 0.0416
Std Test AUC: 0.1301
------------------------------------------------------------
Round 1 time cost: 5.23s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 2)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9327
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 3: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 2 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4534
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6248
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1176
------------------------------------------------------------
Round 2 time cost: 5.44s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 3)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9145

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 4: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 3 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4671
Averaged Test Accuracy: 0.9145
Averaged Test AUC: 0.6320
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9145
Averaged Test F1-Score: 0.8744
Std Test Accuracy: 0.0415
Std Test AUC: 0.1242
------------------------------------------------------------
Round 3 time cost: 5.36s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 4)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Current threshold (based on ACC(t-1)): 0.9327
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 5: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 4 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4715
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6276
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1238
------------------------------------------------------------
Round 4 time cost: 5.59s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 5)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (6/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 5):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          活跃        
  Client 2   1341        1.0000        1341.00         0.1000          活跃        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          活跃        
  Client 5   1341        1.0000        1341.00         0.1000          活跃        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          活跃        
  Client 8   1341        1.0000        1341.00         0.1000          活跃        
  Client 9   1341        1.0000        1341.00         0.1000          活跃        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 6: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 5 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4744
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6363
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1142
------------------------------------------------------------
Round 5 time cost: 4.95s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 6)
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (7/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 7: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 6 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.4832
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6366
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1115
------------------------------------------------------------
Round 6 time cost: 5.39s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 7)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (8/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 8: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 7 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5207
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6403
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1159
------------------------------------------------------------
Round 7 time cost: 5.35s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 8)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [-] 条件(1): 训练轮数不足 (9/10轮) - 强制训练
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 9: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 8 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5217
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6418
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1108
------------------------------------------------------------
Round 8 time cost: 5.32s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 9)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.8814 < 0.9128 [FAIL]
       第9轮: 0.8814 < 0.9128 [FAIL]
       第10轮: 0.8814 < 0.9128 [FAIL]
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.9060 < 0.9128 [FAIL]
       第9轮: 0.9060 < 0.9128 [FAIL]
       第10轮: 0.9060 < 0.9128 [FAIL]
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 2] 早停检查 (当前准确率: 0.9217)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9217 >= 0.9128 [+]
       第9轮: 0.9217 >= 0.9128 [+]
       第10轮: 0.9217 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9217', '0.9217', '0.9217']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 2 reached early stopping criteria (Round 10):
    - Accuracy: 0.9217 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.922', '0.922', '0.922']
  [Virtual Data] Generating and locking virtual data for client 2...
  [Mentor Mode] Client 2 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 2 early stopped at round 9
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [+] 条件(1): 训练轮数充足 (10轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第8轮: 0.8054 < 0.9128 [FAIL]
       第9轮: 0.8054 < 0.9128 [FAIL]
       第10轮: 0.8054 < 0.9128 [FAIL]
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 5] 早停检查 (当前准确率: 0.9172)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9172 >= 0.9128 [+]
       第9轮: 0.9172 >= 0.9128 [+]
       第10轮: 0.9172 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9172', '0.9172', '0.9172']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 5 reached early stopping criteria (Round 10):
    - Accuracy: 0.9172 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.917', '0.917', '0.917']
  [Virtual Data] Generating and locking virtual data for client 5...
  [Mentor Mode] Client 5 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 5 early stopped at round 9
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 9] 早停检查 (当前准确率: 0.9396)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9396 >= 0.9128 [+]
       第9轮: 0.9396 >= 0.9128 [+]
       第10轮: 0.9396 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9396', '0.9396', '0.9396']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 9 reached early stopping criteria (Round 10):
    - Accuracy: 0.9396 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.940', '0.940', '0.940']
  [Virtual Data] Generating and locking virtual data for client 9...
  [Mentor Mode] Client 9 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 9 early stopped at round 9
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 7] 早停检查 (当前准确率: 0.9441)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9441 >= 0.9128 [+]
       第9轮: 0.9441 >= 0.9128 [+]
       第10轮: 0.9441 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9441', '0.9441', '0.9441']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 7 reached early stopping criteria (Round 10):
    - Accuracy: 0.9441 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.944', '0.944', '0.944']
  [Virtual Data] Generating and locking virtual data for client 7...
  [Mentor Mode] Client 7 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 7 early stopped at round 9
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 4] 早停检查 (当前准确率: 0.9396)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9396 >= 0.9128 [+]
       第9轮: 0.9396 >= 0.9128 [+]
       第10轮: 0.9396 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9396', '0.9396', '0.9396']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 4 reached early stopping criteria (Round 10):
    - Accuracy: 0.9396 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.940', '0.940', '0.940']
  [Virtual Data] Generating and locking virtual data for client 4...
  [Mentor Mode] Client 4 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 4 early stopped at round 9
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 8] 早停检查 (当前准确率: 0.9418)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9418 >= 0.9128 [+]
       第9轮: 0.9418 >= 0.9128 [+]
       第10轮: 0.9418 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9418', '0.9418', '0.9418']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 8 reached early stopping criteria (Round 10):
    - Accuracy: 0.9418 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.942', '0.942', '0.942']
  [Virtual Data] Generating and locking virtual data for client 8...
  [Mentor Mode] Client 8 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 8 early stopped at round 9
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 1] 早停检查 (当前准确率: 0.9508)
    [+] 条件(1): 训练轮数充足 (10轮)
    [+] 条件(2): 所有轮次都持续达标
       容忍阈值: 0.9128
       第8轮: 0.9508 >= 0.9128 [+]
       第9轮: 0.9508 >= 0.9128 [+]
       第10轮: 0.9508 >= 0.9128 [+]
    [+] 条件(3): 波动率稳定 (0.0000 <= 0.0200)
       最近3轮: ['0.9508', '0.9508', '0.9508']
    [OK] 所有条件满足 - 客户端达标！
  [Qualified] Client 1 reached early stopping criteria (Round 10):
    - Accuracy: 0.9508 (threshold: 0.9328)
    - Fluctuation: 0.0000 (last 3 rounds)
    - History: ['0.951', '0.951', '0.951']
  [Virtual Data] Generating and locking virtual data for client 1...
  [Mentor Mode] Client 1 enters mentor mode:
    - Continue training model (help weak clients)
    - Continue uploading prototypes (weight auto-decayed by α_k(t))
    - Virtual data locked (privacy preserved)
  [Adaptive Decay] Client 1 early stopped at round 9
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148
  Early-stopped clients: 7/10
  Active training clients: 3

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 9):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          早停        
  Client 2   1341        1.0000        1341.00         0.1000          早停        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          早停        
  Client 5   1341        1.0000        1341.00         0.1000          早停        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          早停        
  Client 8   1341        1.0000        1341.00         0.1000          早停        
  Client 9   1341        1.0000        1341.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C2=1.000 C4=1.000 C5=1.000 C7=1.000 ... (7 total)
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

[Phase Transition Check] Round 10: 前10轮强制Phase 1（共同训练，确保VAE质量）

============================================================
Round 9 | Phase 1
============================================================

Evaluate global model
Averaged Train Loss: 0.5404
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6632
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1112
------------------------------------------------------------
Round 9 time cost: 5.56s
------------------------------------------------------------

[Phase 1] Statistical Collection (Round 10)
  Client 0: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 0: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 0] 早停检查 (当前准确率: 0.8054)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.8054 < 0.9128 [FAIL]
       第10轮: 0.8054 < 0.9128 [FAIL]
       第11轮: 0.8054 < 0.9128 [FAIL]
  Client 1: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 1: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 8: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 8: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 5: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 5: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 3: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 3: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 3] 早停检查 (当前准确率: 0.8814)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.8814 < 0.9128 [FAIL]
       第10轮: 0.8814 < 0.9128 [FAIL]
       第11轮: 0.8814 < 0.9128 [FAIL]
  Client 9: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 9: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 6: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 6: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)

  [Client 6] 早停检查 (当前准确率: 0.9060)
    [+] 条件(1): 训练轮数充足 (11轮)
    [-] 条件(2): 存在低于容忍阈值的轮次
       容忍阈值: 0.9128 (ACC(t)=0.9328 - 0.02)
       第9轮: 0.9060 < 0.9128 [FAIL]
       第10轮: 0.9060 < 0.9128 [FAIL]
       第11轮: 0.9060 < 0.9128 [FAIL]
  Client 2: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 2: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 7: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 7: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  Client 4: [Warm-up Stage] Pretraining classifier on real data (epochs 1-1)
  Client 4: [Joint Training Stage] VAE + Classifier joint training (epochs 2-5)
  [Threshold Decay] Round 11: 衰减 0% (第0步)
    Base: 0.9328 → Decayed: 0.9328 → Final: 0.9328
  Current threshold (based on ACC(t-1)): 0.9328
  Best client accuracy (ACC(t)): 0.9508
  Global average accuracy (ACC(t)): 0.9148

  [Adaptive Decay] 权重衰减计算详情 (Round 11):
  当前全局准确率: 0.9148
  衰减强度λ: 0.5
    Client 2: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 5: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 9: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 7: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 4: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 8: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
    Client 1: 第10轮达标
      达标时准确率: 0.9148
      准确率提升Δ: +0.0000 → max(0,Δ)=0.0000
      衰减权重α_k: exp(-0.5×0.0000) = 1.0000
  Early-stopped clients: 7/10
  Active training clients: 3

  [VAE Aggregation] 联邦聚合VAE参数...
  [OK] VAE参数聚合完成，已分发到 10 个客户端
  参数规模: Encoder=21 layers, Decoder=23 layers

  [Prototype Aggregation] 权重分解详情 (Round 10):
  ================================================================================
  客户端      数据量        衰减α_k        组合权重           归一化权重          状态        
  --------------------------------------------------------------------------------
  Client 0   1341        1.0000        1341.00         0.1000          活跃        
  Client 1   1341        1.0000        1341.00         0.1000          早停        
  Client 2   1341        1.0000        1341.00         0.1000          早停        
  Client 3   1341        1.0000        1341.00         0.1000          活跃        
  Client 4   1341        1.0000        1341.00         0.1000          早停        
  Client 5   1341        1.0000        1341.00         0.1000          早停        
  Client 6   1341        1.0000        1341.00         0.1000          活跃        
  Client 7   1341        1.0000        1341.00         0.1000          早停        
  Client 8   1341        1.0000        1341.00         0.1000          早停        
  Client 9   1341        1.0000        1341.00         0.1000          早停        
  --------------------------------------------------------------------------------
  总组合权重: 13410.00
  归一化检查: Σw_k_norm = 1.000000 (应为1.0)
  ================================================================================

  [Adaptive Decay] Prototype aggregation weights: C1=1.000 C2=1.000 C4=1.000 C5=1.000 C7=1.000 ... (7 total)
  Client 0 received 2 global prototypes
  Client 1 received 2 global prototypes
  Client 2 received 2 global prototypes
  Client 3 received 2 global prototypes
  Client 4 received 2 global prototypes
  Client 5 received 2 global prototypes
  Client 6 received 2 global prototypes
  Client 7 received 2 global prototypes
  Client 8 received 2 global prototypes
  Client 9 received 2 global prototypes

================================================================================
[Phase Transition Check] Round 11 (Phase 1: 最多25轮)
================================================================================
达标要求: 7/10 客户端 (70%)
当前状态: 10/10 客户端达标

客户端详细状态:

[+] 已达标客户端 (10个):
  Client 1: 0.9508 [+]
  Client 7: 0.9441 [+]
  Client 8: 0.9418 [+]
  Client 4: 0.9396 [+]
  Client 9: 0.9396 [+]
  Client 2: 0.9217 [+]
  Client 5: 0.9172 [+]
  Client 6: 0.9060 [+]
  Client 3: 0.8814 [+]
  Client 0: 0.8054 [+]

当前阈值: 0.9328
平均准确率: 0.9148
最佳准确率: 0.9508
================================================================================

[>>] Phase Transition Triggered! (70% Threshold Strategy)
   Qualified clients: 10/10
   Required: 7 (70%)
   Remaining: 0 clients will join dynamically in Phase 2
   Phase 1 completed: 11 rounds (min: 10, max: 25)
================================================================================


============================================================
PHASE TRANSITION: Phase 1 → Phase 2
============================================================
Virtual data pool size: 6030
Phase 2 Algorithm: FEDAVG
Phase 2 Max Rounds: 50
============================================================

  [Algorithm Name] Updated: FedGpro → FedGpro-FedAvg
  Client 0: Phase 2 (already contributed virtual data)
  Client 1: Phase 2 (already contributed virtual data)
  Client 2: Phase 2 (already contributed virtual data)
  Client 3: Phase 2 (already contributed virtual data)
  Client 4: Phase 2 (already contributed virtual data)
  Client 5: Phase 2 (already contributed virtual data)
  Client 6: Phase 2 (already contributed virtual data)
  Client 7: Phase 2 (already contributed virtual data)
  Client 8: Phase 2 (already contributed virtual data)
  Client 9: Phase 2 (already contributed virtual data)
[OK] Phase 2 initialized successfully!
   Algorithm: FEDAVG
   All clients enter Phase 2: 10 (100%)
   - Already contributed virtual data: 10 (100%)
   - Can still contribute (until round 20): 0 (0%)
   Virtual data pool size: 6030 samples
   Phase 1 will continue in parallel until round 20


============================================================
Round 10 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.5482
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.6560
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1138

Evaluate personalized models
Averaged Train Loss (Personalized): 2.4745
Averaged Test Accuracy (Personalized): 0.5273
Averaged Test AUC (Personalized): 0.3790
Std Test Accuracy (Personalized): 0.1575
Std Test AUC (Personalized): 0.1425
------------------------------------------------------------
Round 10 time cost: 5.95s
------------------------------------------------------------

[Phase 2 - Round 11] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 11 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.6988
Averaged Test Accuracy: 0.7342
Averaged Test AUC: 0.5678
Averaged Test Precision: 0.8641
Averaged Test Recall: 0.7342
Averaged Test F1-Score: 0.7841
Std Test Accuracy: 0.0599
Std Test AUC: 0.1041

Evaluate personalized models
Averaged Train Loss (Personalized): 1.0002
Averaged Test Accuracy (Personalized): 0.4770
Averaged Test AUC (Personalized): 0.6085
Std Test Accuracy (Personalized): 0.0983
Std Test AUC (Personalized): 0.1304
------------------------------------------------------------
Round 11 time cost: 18.10s
------------------------------------------------------------

[Phase 2 - Round 12] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 12 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3425
Averaged Test Accuracy: 0.8899
Averaged Test AUC: 0.6453
Averaged Test Precision: 0.8614
Averaged Test Recall: 0.8899
Averaged Test F1-Score: 0.8740
Std Test Accuracy: 0.0512
Std Test AUC: 0.1028

Evaluate personalized models
Averaged Train Loss (Personalized): 0.5769
Averaged Test Accuracy (Personalized): 0.7336
Averaged Test AUC (Personalized): 0.6725
Std Test Accuracy (Personalized): 0.0842
Std Test AUC (Personalized): 0.1147
------------------------------------------------------------
Round 12 time cost: 17.93s
------------------------------------------------------------

[Phase 2 - Round 13] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 13 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3117
Averaged Test Accuracy: 0.9013
Averaged Test AUC: 0.6892
Averaged Test Precision: 0.8531
Averaged Test Recall: 0.9013
Averaged Test F1-Score: 0.8763
Std Test Accuracy: 0.0452
Std Test AUC: 0.1020

Evaluate personalized models
Averaged Train Loss (Personalized): 0.3864
Averaged Test Accuracy (Personalized): 0.8347
Averaged Test AUC (Personalized): 0.7020
Std Test Accuracy (Personalized): 0.0618
Std Test AUC (Personalized): 0.1217
------------------------------------------------------------
Round 13 time cost: 17.72s
------------------------------------------------------------

[Phase 2 - Round 14] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 14 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.3037
Averaged Test Accuracy: 0.9123
Averaged Test AUC: 0.6928
Averaged Test Precision: 0.8598
Averaged Test Recall: 0.9123
Averaged Test F1-Score: 0.8787
Std Test Accuracy: 0.0349
Std Test AUC: 0.1123

Evaluate personalized models
Averaged Train Loss (Personalized): 0.3083
Averaged Test Accuracy (Personalized): 0.8747
Averaged Test AUC (Personalized): 0.7192
Std Test Accuracy (Personalized): 0.0407
Std Test AUC (Personalized): 0.1233
------------------------------------------------------------
Round 14 time cost: 17.69s
------------------------------------------------------------

[Phase 2 - Round 15] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 15 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2921
Averaged Test Accuracy: 0.9112
Averaged Test AUC: 0.7110
Averaged Test Precision: 0.8382
Averaged Test Recall: 0.9112
Averaged Test F1-Score: 0.8728
Std Test Accuracy: 0.0418
Std Test AUC: 0.1197

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2685
Averaged Test Accuracy (Personalized): 0.9025
Averaged Test AUC (Personalized): 0.7415
Std Test Accuracy (Personalized): 0.0315
Std Test AUC (Personalized): 0.1170
------------------------------------------------------------
Round 15 time cost: 18.13s
------------------------------------------------------------

[Phase 2 - Round 16] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 16 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2794
Averaged Test Accuracy: 0.9092
Averaged Test AUC: 0.7089
Averaged Test Precision: 0.8481
Averaged Test Recall: 0.9092
Averaged Test F1-Score: 0.8764
Std Test Accuracy: 0.0451
Std Test AUC: 0.1298

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2439
Averaged Test Accuracy (Personalized): 0.9116
Averaged Test AUC (Personalized): 0.7587
Std Test Accuracy (Personalized): 0.0253
Std Test AUC (Personalized): 0.1115
------------------------------------------------------------
Round 16 time cost: 17.80s
------------------------------------------------------------

[Phase 2 - Round 17] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 17 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2731
Averaged Test Accuracy: 0.9132
Averaged Test AUC: 0.7151
Averaged Test Precision: 0.8488
Averaged Test Recall: 0.9132
Averaged Test F1-Score: 0.8761
Std Test Accuracy: 0.0426
Std Test AUC: 0.1301

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2315
Averaged Test Accuracy (Personalized): 0.9166
Averaged Test AUC (Personalized): 0.7639
Std Test Accuracy (Personalized): 0.0248
Std Test AUC (Personalized): 0.1094
------------------------------------------------------------
Round 17 time cost: 17.44s
------------------------------------------------------------

[Phase 2 - Round 18] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 18 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2681
Averaged Test Accuracy: 0.9132
Averaged Test AUC: 0.7102
Averaged Test Precision: 0.8475
Averaged Test Recall: 0.9132
Averaged Test F1-Score: 0.8760
Std Test Accuracy: 0.0422
Std Test AUC: 0.1279

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2227
Averaged Test Accuracy (Personalized): 0.9174
Averaged Test AUC (Personalized): 0.7704
Std Test Accuracy (Personalized): 0.0246
Std Test AUC (Personalized): 0.1091
------------------------------------------------------------
Round 18 time cost: 17.20s
------------------------------------------------------------

[Phase 2 - Round 19] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 19 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2657
Averaged Test Accuracy: 0.9121
Averaged Test AUC: 0.7190
Averaged Test Precision: 0.8415
Averaged Test Recall: 0.9121
Averaged Test F1-Score: 0.8736
Std Test Accuracy: 0.0430
Std Test AUC: 0.1375

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2135
Averaged Test Accuracy (Personalized): 0.9266
Averaged Test AUC (Personalized): 0.7854
Std Test Accuracy (Personalized): 0.0198
Std Test AUC (Personalized): 0.1045
------------------------------------------------------------
Round 19 time cost: 17.65s
------------------------------------------------------------

[Phase 2 - Round 20] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 20 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2590
Averaged Test Accuracy: 0.9139
Averaged Test AUC: 0.7254
Averaged Test Precision: 0.8636
Averaged Test Recall: 0.9139
Averaged Test F1-Score: 0.8815
Std Test Accuracy: 0.0419
Std Test AUC: 0.1217

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2078
Averaged Test Accuracy (Personalized): 0.9306
Averaged Test AUC (Personalized): 0.7942
Std Test Accuracy (Personalized): 0.0191
Std Test AUC (Personalized): 0.1005
------------------------------------------------------------
Round 20 time cost: 16.63s
------------------------------------------------------------

[Phase 2 - Round 21] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 21 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2604
Averaged Test Accuracy: 0.9168
Averaged Test AUC: 0.7284
Averaged Test Precision: 0.8633
Averaged Test Recall: 0.9168
Averaged Test F1-Score: 0.8814
Std Test Accuracy: 0.0338
Std Test AUC: 0.1259

Evaluate personalized models
Averaged Train Loss (Personalized): 0.2023
Averaged Test Accuracy (Personalized): 0.9315
Averaged Test AUC (Personalized): 0.7975
Std Test Accuracy (Personalized): 0.0186
Std Test AUC (Personalized): 0.1039
------------------------------------------------------------
Round 21 time cost: 14.56s
------------------------------------------------------------

[Phase 2 - Round 22] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 22 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2578
Averaged Test Accuracy: 0.9136
Averaged Test AUC: 0.7260
Averaged Test Precision: 0.8563
Averaged Test Recall: 0.9136
Averaged Test F1-Score: 0.8795
Std Test Accuracy: 0.0419
Std Test AUC: 0.1279

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1986
Averaged Test Accuracy (Personalized): 0.9340
Averaged Test AUC (Personalized): 0.8049
Std Test Accuracy (Personalized): 0.0208
Std Test AUC (Personalized): 0.0981
------------------------------------------------------------
Round 22 time cost: 13.34s
------------------------------------------------------------

[Phase 2 - Round 23] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 23 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2538
Averaged Test Accuracy: 0.9141
Averaged Test AUC: 0.7304
Averaged Test Precision: 0.8417
Averaged Test Recall: 0.9141
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0417
Std Test AUC: 0.1226

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1956
Averaged Test Accuracy (Personalized): 0.9349
Averaged Test AUC (Personalized): 0.8116
Std Test Accuracy (Personalized): 0.0200
Std Test AUC (Personalized): 0.0954
------------------------------------------------------------
Round 23 time cost: 13.28s
------------------------------------------------------------

[Phase 2 - Round 24] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 24 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2485
Averaged Test Accuracy: 0.9206
Averaged Test AUC: 0.7336
Averaged Test Precision: 0.8657
Averaged Test Recall: 0.9206
Averaged Test F1-Score: 0.8875
Std Test Accuracy: 0.0254
Std Test AUC: 0.1141

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1900
Averaged Test Accuracy (Personalized): 0.9347
Averaged Test AUC (Personalized): 0.8163
Std Test Accuracy (Personalized): 0.0210
Std Test AUC (Personalized): 0.0949
------------------------------------------------------------
Round 24 time cost: 13.16s
------------------------------------------------------------

[Phase 2 - Round 25] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 25 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2465
Averaged Test Accuracy: 0.9219
Averaged Test AUC: 0.7297
Averaged Test Precision: 0.8751
Averaged Test Recall: 0.9219
Averaged Test F1-Score: 0.8886
Std Test Accuracy: 0.0256
Std Test AUC: 0.1247

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1884
Averaged Test Accuracy (Personalized): 0.9383
Averaged Test AUC (Personalized): 0.8171
Std Test Accuracy (Personalized): 0.0259
Std Test AUC (Personalized): 0.0942
------------------------------------------------------------
Round 25 time cost: 13.11s
------------------------------------------------------------

[Phase 2 - Round 26] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 26 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2460
Averaged Test Accuracy: 0.9217
Averaged Test AUC: 0.7431
Averaged Test Precision: 0.8731
Averaged Test Recall: 0.9217
Averaged Test F1-Score: 0.8885
Std Test Accuracy: 0.0260
Std Test AUC: 0.1144

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1843
Averaged Test Accuracy (Personalized): 0.9394
Averaged Test AUC (Personalized): 0.8227
Std Test Accuracy (Personalized): 0.0257
Std Test AUC (Personalized): 0.0927
------------------------------------------------------------
Round 26 time cost: 13.11s
------------------------------------------------------------

[Phase 2 - Round 27] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 27 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2476
Averaged Test Accuracy: 0.9172
Averaged Test AUC: 0.7384
Averaged Test Precision: 0.8664
Averaged Test Recall: 0.9172
Averaged Test F1-Score: 0.8816
Std Test Accuracy: 0.0341
Std Test AUC: 0.1159

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1848
Averaged Test Accuracy (Personalized): 0.9385
Averaged Test AUC (Personalized): 0.8284
Std Test Accuracy (Personalized): 0.0262
Std Test AUC (Personalized): 0.0924
------------------------------------------------------------
Round 27 time cost: 13.14s
------------------------------------------------------------

[Phase 2 - Round 28] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 28 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2455
Averaged Test Accuracy: 0.9186
Averaged Test AUC: 0.7383
Averaged Test Precision: 0.8743
Averaged Test Recall: 0.9186
Averaged Test F1-Score: 0.8858
Std Test Accuracy: 0.0326
Std Test AUC: 0.1160

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1801
Averaged Test Accuracy (Personalized): 0.9387
Averaged Test AUC (Personalized): 0.8342
Std Test Accuracy (Personalized): 0.0271
Std Test AUC (Personalized): 0.0897
------------------------------------------------------------
Round 28 time cost: 12.95s
------------------------------------------------------------

[Phase 2 - Round 29] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 29 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2406
Averaged Test Accuracy: 0.9183
Averaged Test AUC: 0.7442
Averaged Test Precision: 0.8665
Averaged Test Recall: 0.9183
Averaged Test F1-Score: 0.8822
Std Test Accuracy: 0.0333
Std Test AUC: 0.1184

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1777
Averaged Test Accuracy (Personalized): 0.9380
Averaged Test AUC (Personalized): 0.8375
Std Test Accuracy (Personalized): 0.0266
Std Test AUC (Personalized): 0.0901
------------------------------------------------------------
Round 29 time cost: 13.03s
------------------------------------------------------------

[Phase 2 - Round 30] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 30 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2432
Averaged Test Accuracy: 0.9186
Averaged Test AUC: 0.7424
Averaged Test Precision: 0.8785
Averaged Test Recall: 0.9186
Averaged Test F1-Score: 0.8827
Std Test Accuracy: 0.0331
Std Test AUC: 0.1171

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1773
Averaged Test Accuracy (Personalized): 0.9391
Averaged Test AUC (Personalized): 0.8413
Std Test Accuracy (Personalized): 0.0263
Std Test AUC (Personalized): 0.0890
------------------------------------------------------------
Round 30 time cost: 13.04s
------------------------------------------------------------

[Phase 2 - Round 31] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 31 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2453
Averaged Test Accuracy: 0.9150
Averaged Test AUC: 0.7422
Averaged Test Precision: 0.8448
Averaged Test Recall: 0.9150
Averaged Test F1-Score: 0.8751
Std Test Accuracy: 0.0418
Std Test AUC: 0.1097

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1735
Averaged Test Accuracy (Personalized): 0.9396
Averaged Test AUC (Personalized): 0.8412
Std Test Accuracy (Personalized): 0.0264
Std Test AUC (Personalized): 0.0900
------------------------------------------------------------
Round 31 time cost: 13.45s
------------------------------------------------------------

[Phase 2 - Round 32] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 32 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2400
Averaged Test Accuracy: 0.9219
Averaged Test AUC: 0.7464
Averaged Test Precision: 0.8691
Averaged Test Recall: 0.9219
Averaged Test F1-Score: 0.8882
Std Test Accuracy: 0.0256
Std Test AUC: 0.1182

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1715
Averaged Test Accuracy (Personalized): 0.9403
Averaged Test AUC (Personalized): 0.8469
Std Test Accuracy (Personalized): 0.0271
Std Test AUC (Personalized): 0.0875
------------------------------------------------------------
Round 32 time cost: 13.11s
------------------------------------------------------------

[Phase 2 - Round 33] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 33 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2398
Averaged Test Accuracy: 0.9183
Averaged Test AUC: 0.7520
Averaged Test Precision: 0.8665
Averaged Test Recall: 0.9183
Averaged Test F1-Score: 0.8822
Std Test Accuracy: 0.0333
Std Test AUC: 0.1064

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1702
Averaged Test Accuracy (Personalized): 0.9403
Averaged Test AUC (Personalized): 0.8483
Std Test Accuracy (Personalized): 0.0265
Std Test AUC (Personalized): 0.0881
------------------------------------------------------------
Round 33 time cost: 12.90s
------------------------------------------------------------

[Phase 2 - Round 34] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 34 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2421
Averaged Test Accuracy: 0.9150
Averaged Test AUC: 0.7519
Averaged Test Precision: 0.8448
Averaged Test Recall: 0.9150
Averaged Test F1-Score: 0.8751
Std Test Accuracy: 0.0418
Std Test AUC: 0.1047

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1675
Averaged Test Accuracy (Personalized): 0.9389
Averaged Test AUC (Personalized): 0.8525
Std Test Accuracy (Personalized): 0.0267
Std Test AUC (Personalized): 0.0864
------------------------------------------------------------
Round 34 time cost: 13.20s
------------------------------------------------------------

[Phase 2 - Round 35] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
  [FedAvg] Weighted average aggregation
[Phase 2] Aggregation complete: FEDAVG

============================================================
Round 35 | Phase 2
============================================================

Evaluate global model
Averaged Train Loss: 0.2410
Averaged Test Accuracy: 0.9148
Averaged Test AUC: 0.7577
Averaged Test Precision: 0.8385
Averaged Test Recall: 0.9148
Averaged Test F1-Score: 0.8746
Std Test Accuracy: 0.0416
Std Test AUC: 0.1098

Evaluate personalized models
Averaged Train Loss (Personalized): 0.1661
Averaged Test Accuracy (Personalized): 0.9405
Averaged Test AUC (Personalized): 0.8573
Std Test Accuracy (Personalized): 0.0268
Std Test AUC (Personalized): 0.0867
------------------------------------------------------------
Round 35 time cost: 13.19s
------------------------------------------------------------

[Phase 2 - Round 36] Algorithm: FEDAVG
  Phase 2 clients: 10 | Phase 1 clients (training): 0
